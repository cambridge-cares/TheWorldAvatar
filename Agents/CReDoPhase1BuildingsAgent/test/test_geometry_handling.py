import pytest

# Import modules under test
from utilities import geojson_creator
from kingslynnagent import query_buildings

# Define test polygons with interior rings [Blazegraph datatype, # interior rings, coordinate string]
poly1 = ['http://localhost/blazegraph/literals/POLYGON-3-15', 0,
         '561522.9#320219.94999#5.7#561512.25#320221.21#5.7#561512.25#320221.21#9.7#561522.9#320219.94999#9.7#561522.9#320219.94999#5.7']
poly2 = ['http://localhost/blazegraph/literals/POLYGON-3-45-18', 1,
         '561522.9000000954#320219.94999980927#5.7#561522.1399998665#320214.40000009537#5.7#561522.0700001717#320214.0#5.7#561521.6399998665#320211.19999980927#5.7#561521.1919999123#320208.40000009537#5.7#561521.1240000725#320207.97499990463#5.7#561518.25#320208.44999980927#5.7#561510.8000001907#320209.67999982834#5.7#561510.0999999046#320209.80000019073#5.7#561508.5#320209.9800000191#5.7#561506.0#320210.2600002289#5.7#561503.4499998093#320210.55000019073#5.7#561504.8000001907#320222.09999990463#5.7#561512.25#320221.21000003815#5.7#561522.9000000954#320219.94999980927#5.7#561513.3499999046#320213.40000009537#5.7#561514.1999998093#320212.75#5.7#561514.5500001907#320215.44999980927#5.7#561511.6999998093#320215.80000019073#5.7#561511.4000000954#320213.65000009537#5.7#561513.3499999046#320213.40000009537#5.7']
poly3 = ['http://localhost/blazegraph/literals/POLYGON-3-450-15-15-15', 3,
         '543709.8600003193#259185.32999912242#12.31#543719.4499999962#259181.79999938907#12.31#543721.6000000914#259187.6999990082#12.31#543734.3000003786#259183.049999387#12.31#543733.0000001881#259179.44999900492#12.31#543737.7500001885#259177.74999919694#12.31#543737.3000003792#259176.44999900527#12.31#543740.9499999981#259175.14999928977#12.31#543741.3500000935#259176.24999919612#12.31#543748.4000002849#259173.79999938505#12.31#543749.6500002849#259177.24999919414#12.31#543751.0300003994#259176.74999919522#12.31#543752.699999999#259176.11999907967#12.31#543750.6000000945#259170.1999990027#12.31#543749.199999999#259170.69999900364#12.31#543747.9499999991#259167.1999990027#12.31#543749.3000003806#259166.69999900294#12.31#543746.6000000947#259159.1499992901#12.31#543749.6999999996#259158.0499993842#12.31#543749.1500002858#259156.5499993841#12.31#543770.3000003832#259148.79999938133#12.31#543771.4500000018#259151.84999909584#12.31#543774.9500000022#259150.59999909552#12.31#543777.9500000019#259159.2499991912#12.31#543779.4000002883#259158.74999919147#12.31#543780.700000002#259162.39999928544#12.31#543779.2500001926#259162.89999928526#12.31#543782.0000001923#259170.79999938182#12.31#543778.7199999823#259171.97999921054#12.31#543780.4200002683#259176.70999923063#12.31#543780.9200002683#259178.07999911567#12.31#543781.0000001919#259178.29999938264#12.31#543787.0000001926#259176.09999909607#12.31#543795.3000003828#259198.869999077#12.31#543798.2500001924#259197.84999909683#12.31#543801.5500003829#259206.69999900006#12.31#543803.100000097#259206.09999909575#12.31#543804.4000002876#259209.59999909665#12.31#543802.9500000015#259210.14999928695#12.31#543803.4000002875#259211.29999938153#12.31#543801.9500000011#259211.86999907822#12.31#543802.3000003827#259212.84999909534#12.31#543803.8000003829#259212.29999938305#12.31#543805.8000003827#259217.79999938275#12.31#543802.5500003826#259218.99999919292#12.31#543804.900000287#259225.3999992872#12.31#543806.8500000964#259224.699999001#12.31#543807.1900002488#259225.57999911532#12.31#543807.8000003826#259227.14999928745#12.31#543813.8500000961#259242.84999909677#12.31#543815.8500000963#259241.99999919385#12.31#543809.1500002875#259223.99999919263#12.31#543811.4000002876#259223.199999001#12.31#543810.5500003829#259220.89999928718#12.31#543811.7500001923#259220.44999900163#12.31#543810.850000097#259217.94999900152#12.31#543814.3000003835#259216.74999919112#12.31#543815.9600002308#259221.3499990963#12.31#543816.94000025#259220.97999921133#12.31#543815.700000002#259217.49999919065#12.31#543817.3500000975#259216.89999928718#12.31#543816.9000002885#259215.6499992854#12.31#543820.6500002887#259214.34999909505#12.31#543821.050000384#259215.5499993807#12.31#543822.7500001936#259214.94999899835#12.31#543822.3000003843#259213.6499992846#12.31#543826.0500003848#259212.2999993804#12.31#543826.4500000031#259213.54999938054#12.31#543827.7000000034#259213.09999909333#12.31#543827.2500001941#259211.79999938043#12.31#543833.9500000039#259209.39999928427#12.31#543829.750000195#259197.59999909223#12.31#543828.1000000993#259198.18999924476#12.31#543826.8000003855#259198.6499992839#12.31#543830.5000001945#259209.04999937903#12.31#543808.7500001923#259216.7999993824#12.31#543801.1000000974#259195.2999993812#12.31#543817.9500000037#259189.08999934176#12.31#543816.7500001945#259185.94999899872#12.31#543810.6000000983#259188.29999937964#12.31#543811.200000003#259189.89999928593#12.31#543807.3000003841#259191.39999928544#12.31#543805.5800001172#259186.83999934257#12.31#543798.7000000022#259189.34999909636#12.31#543793.050000384#259173.84999909563#12.31#543806.1500002898#259168.9699989783#12.31#543809.0500003855#259167.9099990358#12.31#543810.6000000996#259167.34999909342#12.31#543810.0500003857#259165.89999928285#12.31#543808.0500003855#259166.59999909307#12.31#543806.8500000994#259163.34999909237#12.31#543810.1500002905#259162.14999928334#12.31#543805.2500001955#259148.7499991872#12.31#543803.8500000999#259149.24999918716#12.31#543802.3000003861#259145.09999909168#12.31#543803.6500002907#259144.64999928293#12.31#543801.7000000048#259139.29999937656#12.31#543804.969999986#259138.119999071#12.31#543802.6500002914#259131.94999899538#12.31#543799.430000024#259133.0999990912#12.31#543800.6000001002#259136.34999909098#12.31#543797.9000002907#259137.34999909173#12.31#543798.5000001953#259138.89999928323#12.31#543797.1000000997#259139.3999992843#12.31#543797.6100003287#259140.86999907187#12.31#543798.8500000999#259140.39999928142#12.31#543806.6000000995#259161.74999918713#12.31#543799.7500001942#259164.22999920748#12.31#543801.4500000033#259168.74999918838#12.31#543797.0000001936#259170.39999928474#12.31#543796.4000002891#259168.7999993806#12.31#543790.4000002885#259171.0499993801#12.31#543791.8500000976#259174.89999928582#12.31#543788.8000003835#259176.049999382#12.31#543786.200000002#259169.1999989991#12.31#543784.8000003833#259169.69999900073#12.31#543777.0000001931#259148.29999938034#12.31#543776.6500002885#259147.19999899899#12.31#543772.1500002879#259148.79999938182#12.31#543770.2600004218#259143.5399991519#12.31#543768.7000000019#259144.0999990955#12.31#543769.5500003834#259146.34999909412#12.31#543748.4000002858#259153.9499990021#12.31#543747.9200002669#259152.6599990407#12.31#543744.7500001902#259153.84999909796#12.31#543743.0500003811#259149.09999909674#12.31#543740.1000000946#259150.1899992514#12.31#543747.7500001896#259171.09999909764#12.31#543725.6500002829#259179.19999900623#12.31#543717.719999978#259157.61999908113#12.31#543716.1600000351#259158.19999900623#12.31#543716.400000283#259158.84999910143#12.31#543713.4499999967#259159.94999900562#12.31#543713.2100002255#259159.27999940733#12.31#543711.3400003398#259159.96999898696#12.31#543712.9000002826#259164.26999917897#12.31#543717.6500002829#259162.39999929332#12.31#543720.0000001875#259168.4499990074#12.31#543715.1500002824#259170.24999919737#12.31#543715.4400002443#259170.99999919723#12.31#543718.6500002828#259169.7499991969#12.31#543720.6999999965#259174.9999991978#12.31#543722.1000000922#259174.44999900585#12.31#543723.6999999967#259178.49999919807#12.31#543718.949999996#259180.34999910335#12.31#543717.0300003967#259175.37999931342#12.31#543701.610000319#259181.20999923896#12.31#543703.9100000326#259187.51999918022#12.31#543708.3600003193#259185.87999931455#12.31#543709.8600003193#259185.32999912242#12.31#543795.600000097#259195.3999992868#12.31#543794.5000001923#259192.14999928646#12.31#543799.7500001928#259190.34999909624#12.31#543800.9000002883#259193.5499993807#12.31#543795.600000097#259195.3999992868#12.31#543794.0#259190.0#12.31#543793.0#259189.0#12.31#543794.0#259188.0#12.31#543795.0#259190.0#12.31#543794.0#259190.0#12.31#543792.0#259186.0#12.31#543791.0#259185.0#12.31#543792.0#259184.0#12.31#543793.0#259186.0#12.31#543792.0#259186.0#12.31']

# Define test (Multi-)Polygons to test correct translation into GeoJSON
# Polygon without interior ring
coords1 = [[[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]]]]
geojson1 = {'type': 'FeatureCollection', 'features': [{'type': 'Feature', 'id': 1, 'properties': {'displayName': 'test'}, 'geometry': {'type': 'Polygon', 'coordinates': [[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]]]}}]}
# Polygon without 2 interior rings
coords2 = [[[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]], [[0.10323416047381584, 52.21223209950535], [0.10321669323054561, 52.21220318695059], [0.10329271345656384, 52.21218564739626], [0.10331089080430161, 52.21221409769794], [0.10323416047381584, 52.21223209950535]]]]
geojson2 = {'type': 'FeatureCollection', 'features': [{'type': 'Feature', 'id': 1, 'properties': {'displayName': 'test'}, 'geometry': {'type': 'Polygon', 'coordinates': [[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]], [[0.10323416047381584, 52.21223209950535], [0.10321669323054561, 52.21220318695059], [0.10329271345656384, 52.21218564739626], [0.10331089080430161, 52.21221409769794], [0.10323416047381584, 52.21223209950535]]]}}]}
# Polygon without 3 interior rings
coords3 = [[[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]], [[0.10323416047381584, 52.21223209950535], [0.10321669323054561, 52.21220318695059], [0.10329271345656384, 52.21218564739626], [0.10331089080430161, 52.21221409769794], [0.10323416047381584, 52.21223209950535]], [[0.10320846810852996, 52.21218400087128], [0.10319341822916663, 52.21217527703892], [0.1032076194125299, 52.212166032179766], [0.10322309364257025, 52.212183740356], [0.10320846810852996, 52.21218400087128]]]]
geojson3 = {'type': 'FeatureCollection', 'features': [{'type': 'Feature', 'id': 1, 'properties': {'displayName': 'test'}, 'geometry': {'type': 'Polygon', 'coordinates': [[[0.10197589434745313, 52.21216395719883], [0.10211465610309771, 52.2121297454818], [0.10214860334379369, 52.21218219334619], [0.10233237535763598, 52.2121371091009], [0.10231183518601006, 52.21210510395462], [0.10238058528632595, 52.2120885936242], [0.10237345238309517, 52.21207703114971], [0.10242628403315249, 52.212064400985604], [0.10243260083973792, 52.21207417960465], [0.1025346713368335, 52.21205033195758], [0.10255441673437637, 52.212081002426785], [0.10257438782596903, 52.21207615085259], [0.10259854515238079, 52.21207005578163], [0.10256532025631683, 52.21201741534114], [0.10254505668103416, 52.21202227212202], [0.10252529010760728, 52.21199115243109], [0.10254482240126732, 52.21198630867529], [0.10250213091394843, 52.211919179982985], [0.10254700318399068, 52.211908489870645], [0.1025383228836869, 52.2118951565806], [0.10284436288328565, 52.21182001938489], [0.1028624761319574, 52.21184712210801], [0.10291313476266041, 52.21183498001811], [0.10296068114466021, 52.21191191319444], [0.10298167589529576, 52.21190704331957], [0.10300223766719274, 52.211939497557935], [0.10298124291036229, 52.21194436743656], [0.10302481493611879, 52.21201462744203], [0.1029773440323491, 52.212026083370304], [0.10300421431416415, 52.212068136507106], [0.1030121083617209, 52.21208031481753], [0.10301337174819662, 52.2120822705372], [0.10310019124155205, 52.21206094200164], [0.10323124532045824, 52.212263353337455], [0.1032739578703337, 52.212253420770594], [0.10332597791768837, 52.21233207248497], [0.10334839293902304, 52.2123262780558], [0.10336889153934033, 52.21235738456699], [0.10334791783699482, 52.21236270373251], [0.10335498739651448, 52.2123729184894], [0.10333402217228363, 52.212378417335046], [0.10333955702806949, 52.21238713080668], [0.10336126201916983, 52.212381798620086], [0.10339284735958562, 52.2124306914397], [0.10334582336492301, 52.21244231939246], [0.10338290965531774, 52.212499206937586], [0.10341113257059771, 52.2124924098421], [0.1034164787575847, 52.2125002274814], [0.10342606670415458, 52.21251417397143], [0.10352121520492613, 52.2126536518321], [0.10355010582063451, 52.21264549402632], [0.1034444744543487, 52.21248552155342], [0.10347704260197096, 52.212477747845234], [0.10346363468501867, 52.212457305324286], [0.10348099444638091, 52.212452949708805], [0.10346677037079156, 52.212430723344305], [0.1035167194455037, 52.212419043233275], [0.10354295029303902, 52.212459938687665], [0.1035571263674823, 52.21245635913466], [0.10353751360899383, 52.212425416713224], [0.10356139121535692, 52.212419596187544], [0.10355427916447679, 52.21240848301054], [0.10360857342202504, 52.21239582625622], [0.10361493298679454, 52.21240650324343], [0.10363954184778273, 52.21240066966976], [0.10363240855845325, 52.2123891072832], [0.10368668154579601, 52.2123760012792], [0.10369306234207512, 52.21238712747659], [0.10371115333424583, 52.21238275879925], [0.10370402002905948, 52.21237119641729], [0.10380099275383112, 52.212347888091884], [0.1037345566849172, 52.21224296731501], [0.10371067495470193, 52.21224869803256], [0.1036918569888488, 52.212253169578766], [0.10375038592982992, 52.21234564259366], [0.10343556852221679, 52.21242093849898], [0.1033145585588213, 52.212229768196096], [0.10355836336358774, 52.21216958527426], [0.1035394800676601, 52.21214168710085], [0.10345053046854596, 52.21216440269264], [0.10345998482211236, 52.212178621315225], [0.10340358184193997, 52.212193113945325], [0.10337649073054335, 52.21215259345863], [0.10327693228067415, 52.21217693660114], [0.10318772070827457, 52.2120391511633], [0.10337724357144833, 52.21199189471104], [0.1034192075768369, 52.211981615749714], [0.10344163938150185, 52.211976180679414], [0.10343298001415369, 52.21196329667944], [0.10340402616772339, 52.21197010679714], [0.10338509637166729, 52.21194122032007], [0.10343285109204627, 52.2119295793336], [0.1033554997843424, 52.21181046573532], [0.10333523639708418, 52.21181532264878], [0.10331080590838773, 52.21177844142964], [0.10333035922730893, 52.211774046766], [0.10329956937332557, 52.21172648854135], [0.10334689360611977, 52.211715035091316], [0.10331034442714603, 52.21166020609887], [0.10326373877684046, 52.21167137697535], [0.10328222960606484, 52.21170027129236], [0.10324316545492927, 52.21170995903764], [0.103252598420735, 52.21172372846612], [0.10323233506164277, 52.21172858536145], [0.10324041780030753, 52.211741659485746], [0.10325835382908162, 52.21173711380418], [0.10338076100097492, 52.21192691050277], [0.10328162910310616, 52.211950976296734], [0.1033084105050766, 52.21199114264751], [0.10324402735343231, 52.212007126139916], [0.1032345731088986, 52.211992907497724], [0.10314777503582817, 52.21201468534354], [0.10317061567634497, 52.212048897340466], [0.10312649591646073, 52.212060023883474], [0.10308556303046952, 52.211999158407], [0.10306529953130597, 52.21200401527596], [0.10294214101349175, 52.211813782040636], [0.1029365554055559, 52.211803990421615], [0.1028714198996237, 52.21181953751769], [0.10284154622469424, 52.21177277212558], [0.10281896818166664, 52.21177820968623], [0.10283235437293933, 52.21179820307686], [0.10252625087385234, 52.211871992585756], [0.10251868344535608, 52.21186052777818], [0.10247282561148915, 52.21187204470161], [0.1024459474901969, 52.21182981174403], [0.10240326484159773, 52.21184037291399], [0.10252401941052948, 52.212026243486584], [0.10220423160256578, 52.21210477177821], [0.1020790988794737, 52.211912954246266], [0.10205652915363997, 52.211918571350665], [0.10206031493618427, 52.211924348693046], [0.10201763633856482, 52.211934999567944], [0.10201384208592125, 52.21192904254136], [0.10198678510060642, 52.21193572862166], [0.10201142443847018, 52.21197395518311], [0.1020801023528357, 52.21195591768818], [0.10211703812284355, 52.212009661145565], [0.10204686790496703, 52.21202709579794], [0.10205142737726516, 52.21203375855654], [0.10209784506902447, 52.212021692316426], [0.10213005396497715, 52.2120683264], [0.10215029640353916, 52.21206302046984], [0.10217541494624945, 52.21209899048869], [0.10210672836620412, 52.21211684835515], [0.10207653952684079, 52.21207269603827], [0.10185348648203417, 52.212129089575704], [0.10188980110665745, 52.212185182057], [0.1019541892873598, 52.21216928913609], [0.10197589434745313, 52.21216395719883]], [[0.10323416047381584, 52.21223209950535], [0.10321669323054561, 52.21220318695059], [0.10329271345656384, 52.21218564739626], [0.10331089080430161, 52.21221409769794], [0.10323416047381584, 52.21223209950535]], [[0.10320846810852996, 52.21218400087128], [0.10319341822916663, 52.21217527703892], [0.1032076194125299, 52.212166032179766], [0.10322309364257025, 52.212183740356], [0.10320846810852996, 52.21218400087128]]]}}]}
# Multipolygon with 2 Polygons, where one has an interior ring
coords4 = [[[[0.10197589434745313, 52.21216395719883, 12.31], [0.10211465610309771, 52.2121297454818, 12.31], [0.10214860334379369, 52.21218219334619, 12.31], [0.10233237535763598, 52.2121371091009, 12.31], [0.10231183518601006, 52.21210510395462, 12.31], [0.10238058528632595, 52.2120885936242, 12.31], [0.10237345238309517, 52.21207703114971, 12.31], [0.10242628403315249, 52.212064400985604, 12.31], [0.10243260083973792, 52.21207417960465, 12.31], [0.1025346713368335, 52.21205033195758, 12.31], [0.10255441673437637, 52.212081002426785, 12.31], [0.10257438782596903, 52.21207615085259, 12.31], [0.10259854515238079, 52.21207005578163, 12.31], [0.10256532025631683, 52.21201741534114, 12.31], [0.10254505668103416, 52.21202227212202, 12.31], [0.10252529010760728, 52.21199115243109, 12.31], [0.10254482240126732, 52.21198630867529, 12.31], [0.10250213091394843, 52.211919179982985, 12.31], [0.10254700318399068, 52.211908489870645, 12.31], [0.1025383228836869, 52.2118951565806, 12.31], [0.10284436288328565, 52.21182001938489, 12.31], [0.1028624761319574, 52.21184712210801, 12.31], [0.10291313476266041, 52.21183498001811, 12.31], [0.10296068114466021, 52.21191191319444, 12.31], [0.10298167589529576, 52.21190704331957, 12.31], [0.10300223766719274, 52.211939497557935, 12.31], [0.10298124291036229, 52.21194436743656, 12.31], [0.10302481493611879, 52.21201462744203, 12.31], [0.1029773440323491, 52.212026083370304, 12.31], [0.10300421431416415, 52.212068136507106, 12.31], [0.1030121083617209, 52.21208031481753, 12.31], [0.10301337174819662, 52.2120822705372, 12.31], [0.10310019124155205, 52.21206094200164, 12.31], [0.10323124532045824, 52.212263353337455, 12.31], [0.1032739578703337, 52.212253420770594, 12.31], [0.10332597791768837, 52.21233207248497, 12.31], [0.10334839293902304, 52.2123262780558, 12.31], [0.10336889153934033, 52.21235738456699, 12.31], [0.10334791783699482, 52.21236270373251, 12.31], [0.10335498739651448, 52.2123729184894, 12.31], [0.10333402217228363, 52.212378417335046, 12.31], [0.10333955702806949, 52.21238713080668, 12.31], [0.10336126201916983, 52.212381798620086, 12.31], [0.10339284735958562, 52.2124306914397, 12.31], [0.10334582336492301, 52.21244231939246, 12.31], [0.10338290965531774, 52.212499206937586, 12.31], [0.10341113257059771, 52.2124924098421, 12.31], [0.1034164787575847, 52.2125002274814, 12.31], [0.10342606670415458, 52.21251417397143, 12.31], [0.10352121520492613, 52.2126536518321, 12.31], [0.10355010582063451, 52.21264549402632, 12.31], [0.1034444744543487, 52.21248552155342, 12.31], [0.10347704260197096, 52.212477747845234, 12.31], [0.10346363468501867, 52.212457305324286, 12.31], [0.10348099444638091, 52.212452949708805, 12.31], [0.10346677037079156, 52.212430723344305, 12.31], [0.1035167194455037, 52.212419043233275, 12.31], [0.10354295029303902, 52.212459938687665, 12.31], [0.1035571263674823, 52.21245635913466, 12.31], [0.10353751360899383, 52.212425416713224, 12.31], [0.10356139121535692, 52.212419596187544, 12.31], [0.10355427916447679, 52.21240848301054, 12.31], [0.10360857342202504, 52.21239582625622, 12.31], [0.10361493298679454, 52.21240650324343, 12.31], [0.10363954184778273, 52.21240066966976, 12.31], [0.10363240855845325, 52.2123891072832, 12.31], [0.10368668154579601, 52.2123760012792, 12.31], [0.10369306234207512, 52.21238712747659, 12.31], [0.10371115333424583, 52.21238275879925, 12.31], [0.10370402002905948, 52.21237119641729, 12.31], [0.10380099275383112, 52.212347888091884, 12.31], [0.1037345566849172, 52.21224296731501, 12.31], [0.10371067495470193, 52.21224869803256, 12.31], [0.1036918569888488, 52.212253169578766, 12.31], [0.10375038592982992, 52.21234564259366, 12.31], [0.10343556852221679, 52.21242093849898, 12.31], [0.1033145585588213, 52.212229768196096, 12.31], [0.10355836336358774, 52.21216958527426, 12.31], [0.1035394800676601, 52.21214168710085, 12.31], [0.10345053046854596, 52.21216440269264, 12.31], [0.10345998482211236, 52.212178621315225, 12.31], [0.10340358184193997, 52.212193113945325, 12.31], [0.10337649073054335, 52.21215259345863, 12.31], [0.10327693228067415, 52.21217693660114, 12.31], [0.10318772070827457, 52.2120391511633, 12.31], [0.10337724357144833, 52.21199189471104, 12.31], [0.1034192075768369, 52.211981615749714, 12.31], [0.10344163938150185, 52.211976180679414, 12.31], [0.10343298001415369, 52.21196329667944, 12.31], [0.10340402616772339, 52.21197010679714, 12.31], [0.10338509637166729, 52.21194122032007, 12.31], [0.10343285109204627, 52.2119295793336, 12.31], [0.1033554997843424, 52.21181046573532, 12.31], [0.10333523639708418, 52.21181532264878, 12.31], [0.10331080590838773, 52.21177844142964, 12.31], [0.10333035922730893, 52.211774046766, 12.31], [0.10329956937332557, 52.21172648854135, 12.31], [0.10334689360611977, 52.211715035091316, 12.31], [0.10331034442714603, 52.21166020609887, 12.31], [0.10326373877684046, 52.21167137697535, 12.31], [0.10328222960606484, 52.21170027129236, 12.31], [0.10324316545492927, 52.21170995903764, 12.31], [0.103252598420735, 52.21172372846612, 12.31], [0.10323233506164277, 52.21172858536145, 12.31], [0.10324041780030753, 52.211741659485746, 12.31], [0.10325835382908162, 52.21173711380418, 12.31], [0.10338076100097492, 52.21192691050277, 12.31], [0.10328162910310616, 52.211950976296734, 12.31], [0.1033084105050766, 52.21199114264751, 12.31], [0.10324402735343231, 52.212007126139916, 12.31], [0.1032345731088986, 52.211992907497724, 12.31], [0.10314777503582817, 52.21201468534354, 12.31], [0.10317061567634497, 52.212048897340466, 12.31], [0.10312649591646073, 52.212060023883474, 12.31], [0.10308556303046952, 52.211999158407, 12.31], [0.10306529953130597, 52.21200401527596, 12.31], [0.10294214101349175, 52.211813782040636, 12.31], [0.1029365554055559, 52.211803990421615, 12.31], [0.1028714198996237, 52.21181953751769, 12.31], [0.10284154622469424, 52.21177277212558, 12.31], [0.10281896818166664, 52.21177820968623, 12.31], [0.10283235437293933, 52.21179820307686, 12.31], [0.10252625087385234, 52.211871992585756, 12.31], [0.10251868344535608, 52.21186052777818, 12.31], [0.10247282561148915, 52.21187204470161, 12.31], [0.1024459474901969, 52.21182981174403, 12.31], [0.10240326484159773, 52.21184037291399, 12.31], [0.10252401941052948, 52.212026243486584, 12.31], [0.10220423160256578, 52.21210477177821, 12.31], [0.1020790988794737, 52.211912954246266, 12.31], [0.10205652915363997, 52.211918571350665, 12.31], [0.10206031493618427, 52.211924348693046, 12.31], [0.10201763633856482, 52.211934999567944, 12.31], [0.10201384208592125, 52.21192904254136, 12.31], [0.10198678510060642, 52.21193572862166, 12.31], [0.10201142443847018, 52.21197395518311, 12.31], [0.1020801023528357, 52.21195591768818, 12.31], [0.10211703812284355, 52.212009661145565, 12.31], [0.10204686790496703, 52.21202709579794, 12.31], [0.10205142737726516, 52.21203375855654, 12.31], [0.10209784506902447, 52.212021692316426, 12.31], [0.10213005396497715, 52.2120683264, 12.31], [0.10215029640353916, 52.21206302046984, 12.31], [0.10217541494624945, 52.21209899048869, 12.31], [0.10210672836620412, 52.21211684835515, 12.31], [0.10207653952684079, 52.21207269603827, 12.31], [0.10185348648203417, 52.212129089575704, 12.31], [0.10188980110665745, 52.212185182057, 12.31], [0.1019541892873598, 52.21216928913609, 12.31], [0.10197589434745313, 52.21216395719883, 12.31]], [[0.10323416047381584, 52.21223209950535, 12.31], [0.10321669323054561, 52.21220318695059, 12.31], [0.10329271345656384, 52.21218564739626, 12.31], [0.10331089080430161, 52.21221409769794, 12.31], [0.10323416047381584, 52.21223209950535, 12.31]]], [[[0.10323416047381584, 52.21223209950535, 20.0], [0.10321669323054561, 52.21220318695059, 20.0], [0.10329271345656384, 52.21218564739626, 20.0], [0.10331089080430161, 52.21221409769794, 20.0], [0.10323416047381584, 52.21223209950535, 20.0]]]]
geojson4 = {'type': 'FeatureCollection', 'features': [{'type': 'Feature', 'id': 1, 'properties': {'displayName': 'test'}, 'geometry': {'type': 'MultiPolygon', 'coordinates': [[[[0.10197589434745313, 52.21216395719883, 12.31], [0.10211465610309771, 52.2121297454818, 12.31], [0.10214860334379369, 52.21218219334619, 12.31], [0.10233237535763598, 52.2121371091009, 12.31], [0.10231183518601006, 52.21210510395462, 12.31], [0.10238058528632595, 52.2120885936242, 12.31], [0.10237345238309517, 52.21207703114971, 12.31], [0.10242628403315249, 52.212064400985604, 12.31], [0.10243260083973792, 52.21207417960465, 12.31], [0.1025346713368335, 52.21205033195758, 12.31], [0.10255441673437637, 52.212081002426785, 12.31], [0.10257438782596903, 52.21207615085259, 12.31], [0.10259854515238079, 52.21207005578163, 12.31], [0.10256532025631683, 52.21201741534114, 12.31], [0.10254505668103416, 52.21202227212202, 12.31], [0.10252529010760728, 52.21199115243109, 12.31], [0.10254482240126732, 52.21198630867529, 12.31], [0.10250213091394843, 52.211919179982985, 12.31], [0.10254700318399068, 52.211908489870645, 12.31], [0.1025383228836869, 52.2118951565806, 12.31], [0.10284436288328565, 52.21182001938489, 12.31], [0.1028624761319574, 52.21184712210801, 12.31], [0.10291313476266041, 52.21183498001811, 12.31], [0.10296068114466021, 52.21191191319444, 12.31], [0.10298167589529576, 52.21190704331957, 12.31], [0.10300223766719274, 52.211939497557935, 12.31], [0.10298124291036229, 52.21194436743656, 12.31], [0.10302481493611879, 52.21201462744203, 12.31], [0.1029773440323491, 52.212026083370304, 12.31], [0.10300421431416415, 52.212068136507106, 12.31], [0.1030121083617209, 52.21208031481753, 12.31], [0.10301337174819662, 52.2120822705372, 12.31], [0.10310019124155205, 52.21206094200164, 12.31], [0.10323124532045824, 52.212263353337455, 12.31], [0.1032739578703337, 52.212253420770594, 12.31], [0.10332597791768837, 52.21233207248497, 12.31], [0.10334839293902304, 52.2123262780558, 12.31], [0.10336889153934033, 52.21235738456699, 12.31], [0.10334791783699482, 52.21236270373251, 12.31], [0.10335498739651448, 52.2123729184894, 12.31], [0.10333402217228363, 52.212378417335046, 12.31], [0.10333955702806949, 52.21238713080668, 12.31], [0.10336126201916983, 52.212381798620086, 12.31], [0.10339284735958562, 52.2124306914397, 12.31], [0.10334582336492301, 52.21244231939246, 12.31], [0.10338290965531774, 52.212499206937586, 12.31], [0.10341113257059771, 52.2124924098421, 12.31], [0.1034164787575847, 52.2125002274814, 12.31], [0.10342606670415458, 52.21251417397143, 12.31], [0.10352121520492613, 52.2126536518321, 12.31], [0.10355010582063451, 52.21264549402632, 12.31], [0.1034444744543487, 52.21248552155342, 12.31], [0.10347704260197096, 52.212477747845234, 12.31], [0.10346363468501867, 52.212457305324286, 12.31], [0.10348099444638091, 52.212452949708805, 12.31], [0.10346677037079156, 52.212430723344305, 12.31], [0.1035167194455037, 52.212419043233275, 12.31], [0.10354295029303902, 52.212459938687665, 12.31], [0.1035571263674823, 52.21245635913466, 12.31], [0.10353751360899383, 52.212425416713224, 12.31], [0.10356139121535692, 52.212419596187544, 12.31], [0.10355427916447679, 52.21240848301054, 12.31], [0.10360857342202504, 52.21239582625622, 12.31], [0.10361493298679454, 52.21240650324343, 12.31], [0.10363954184778273, 52.21240066966976, 12.31], [0.10363240855845325, 52.2123891072832, 12.31], [0.10368668154579601, 52.2123760012792, 12.31], [0.10369306234207512, 52.21238712747659, 12.31], [0.10371115333424583, 52.21238275879925, 12.31], [0.10370402002905948, 52.21237119641729, 12.31], [0.10380099275383112, 52.212347888091884, 12.31], [0.1037345566849172, 52.21224296731501, 12.31], [0.10371067495470193, 52.21224869803256, 12.31], [0.1036918569888488, 52.212253169578766, 12.31], [0.10375038592982992, 52.21234564259366, 12.31], [0.10343556852221679, 52.21242093849898, 12.31], [0.1033145585588213, 52.212229768196096, 12.31], [0.10355836336358774, 52.21216958527426, 12.31], [0.1035394800676601, 52.21214168710085, 12.31], [0.10345053046854596, 52.21216440269264, 12.31], [0.10345998482211236, 52.212178621315225, 12.31], [0.10340358184193997, 52.212193113945325, 12.31], [0.10337649073054335, 52.21215259345863, 12.31], [0.10327693228067415, 52.21217693660114, 12.31], [0.10318772070827457, 52.2120391511633, 12.31], [0.10337724357144833, 52.21199189471104, 12.31], [0.1034192075768369, 52.211981615749714, 12.31], [0.10344163938150185, 52.211976180679414, 12.31], [0.10343298001415369, 52.21196329667944, 12.31], [0.10340402616772339, 52.21197010679714, 12.31], [0.10338509637166729, 52.21194122032007, 12.31], [0.10343285109204627, 52.2119295793336, 12.31], [0.1033554997843424, 52.21181046573532, 12.31], [0.10333523639708418, 52.21181532264878, 12.31], [0.10331080590838773, 52.21177844142964, 12.31], [0.10333035922730893, 52.211774046766, 12.31], [0.10329956937332557, 52.21172648854135, 12.31], [0.10334689360611977, 52.211715035091316, 12.31], [0.10331034442714603, 52.21166020609887, 12.31], [0.10326373877684046, 52.21167137697535, 12.31], [0.10328222960606484, 52.21170027129236, 12.31], [0.10324316545492927, 52.21170995903764, 12.31], [0.103252598420735, 52.21172372846612, 12.31], [0.10323233506164277, 52.21172858536145, 12.31], [0.10324041780030753, 52.211741659485746, 12.31], [0.10325835382908162, 52.21173711380418, 12.31], [0.10338076100097492, 52.21192691050277, 12.31], [0.10328162910310616, 52.211950976296734, 12.31], [0.1033084105050766, 52.21199114264751, 12.31], [0.10324402735343231, 52.212007126139916, 12.31], [0.1032345731088986, 52.211992907497724, 12.31], [0.10314777503582817, 52.21201468534354, 12.31], [0.10317061567634497, 52.212048897340466, 12.31], [0.10312649591646073, 52.212060023883474, 12.31], [0.10308556303046952, 52.211999158407, 12.31], [0.10306529953130597, 52.21200401527596, 12.31], [0.10294214101349175, 52.211813782040636, 12.31], [0.1029365554055559, 52.211803990421615, 12.31], [0.1028714198996237, 52.21181953751769, 12.31], [0.10284154622469424, 52.21177277212558, 12.31], [0.10281896818166664, 52.21177820968623, 12.31], [0.10283235437293933, 52.21179820307686, 12.31], [0.10252625087385234, 52.211871992585756, 12.31], [0.10251868344535608, 52.21186052777818, 12.31], [0.10247282561148915, 52.21187204470161, 12.31], [0.1024459474901969, 52.21182981174403, 12.31], [0.10240326484159773, 52.21184037291399, 12.31], [0.10252401941052948, 52.212026243486584, 12.31], [0.10220423160256578, 52.21210477177821, 12.31], [0.1020790988794737, 52.211912954246266, 12.31], [0.10205652915363997, 52.211918571350665, 12.31], [0.10206031493618427, 52.211924348693046, 12.31], [0.10201763633856482, 52.211934999567944, 12.31], [0.10201384208592125, 52.21192904254136, 12.31], [0.10198678510060642, 52.21193572862166, 12.31], [0.10201142443847018, 52.21197395518311, 12.31], [0.1020801023528357, 52.21195591768818, 12.31], [0.10211703812284355, 52.212009661145565, 12.31], [0.10204686790496703, 52.21202709579794, 12.31], [0.10205142737726516, 52.21203375855654, 12.31], [0.10209784506902447, 52.212021692316426, 12.31], [0.10213005396497715, 52.2120683264, 12.31], [0.10215029640353916, 52.21206302046984, 12.31], [0.10217541494624945, 52.21209899048869, 12.31], [0.10210672836620412, 52.21211684835515, 12.31], [0.10207653952684079, 52.21207269603827, 12.31], [0.10185348648203417, 52.212129089575704, 12.31], [0.10188980110665745, 52.212185182057, 12.31], [0.1019541892873598, 52.21216928913609, 12.31], [0.10197589434745313, 52.21216395719883, 12.31]], [[0.10323416047381584, 52.21223209950535, 12.31], [0.10321669323054561, 52.21220318695059, 12.31], [0.10329271345656384, 52.21218564739626, 12.31], [0.10331089080430161, 52.21221409769794, 12.31], [0.10323416047381584, 52.21223209950535, 12.31]]], [[[0.10323416047381584, 52.21223209950535, 20.0], [0.10321669323054561, 52.21220318695059, 20.0], [0.10329271345656384, 52.21218564739626, 20.0], [0.10331089080430161, 52.21221409769794, 20.0], [0.10323416047381584, 52.21223209950535, 20.0]]]]}}]}


@pytest.mark.parametrize("polygon", [poly1, poly2, poly3])
def test_extraction_of_linear_rings(polygon):
    # Split polygon (and neglect dimension)
    splitted, _ = query_buildings.split_polygon_data(polygon[2], polygon[0])

    # Check for extraction of correct number of linear rings
    assert len(splitted)-1 == polygon[1]

    # Check for correct extraction of linear rings
    recombined = ''
    for ring in splitted:
        for r in ring:
            recombined += str(r) + '#'
    recombined = recombined[:-1]
    assert recombined == polygon[2]


@pytest.mark.parametrize("polygon, geojson", [(coords1, geojson1), (coords2, geojson2), (coords3, geojson3),
                                              (coords4, geojson4)])
def test_creation_of_geojson(polygon, geojson):
    # Define geojson properties
    geojson_props = {'displayName': 'test'}
    feature_id = 1
    # Initialise GeoJSON
    output = geojson_creator.initialise_geojson('urn:ogc:def:crs:OGC::CRS84')
    # Append (Multi-)Polygon data
    output['features'].append(geojson_creator.add_feature(feature_id, geojson_props, polygon))
    # Test correct creation of GeoJSON dictionary
    assert output == geojson