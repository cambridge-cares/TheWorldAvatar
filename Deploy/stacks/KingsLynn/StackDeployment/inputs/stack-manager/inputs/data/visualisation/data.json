{
    "name": "All Data",
    "groups": [
        {
            "name": "Buildings",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "area-of-interest",
                    "type": "geojson",
                    "data": "data/aoi.geojson", 
                    "generateId": true
                },
                {
                    "id": "ocgml_buildings",
                    "type": "geojson",
                    "data": "data/buildings/os_bha_buildings.geojson"
                },
                {
                    "id": "obe_buildings",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:buildings&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "building_sales",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:transactions&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "building_values",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:marketvalues&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                }
            ], 
            "layers": [
                {
                    "id": "buildings-layer-value",
                    "name": "Property Value Estimates",
                    "source": "building_values",
                    "source-layer": "marketvalues",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 23,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "case", 
                            ["==", ["get", "price"], null], "#000000", [
                            "interpolate", ["linear"],
                            ["number", ["get", "price"]],
                            50000, "#0769AD",
                            1200000, "#AD0202"
                        ]],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "buildings-layer-sales",
                    "name": "Actual Property Sales",
                    "source": "building_sales",
                    "source-layer": "transactions",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 22,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "case", 
                            ["==", ["get", "price"], null], "#000000", [
                            "interpolate", ["linear"],
                            ["number", ["get", "price"]],
                            50000, "#0769AD",
                            1200000, "#AD0202"
                        ]],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "obe_buildings-layer-usage",
                    "name": "Buildings with usage information",
                    "source": "obe_buildings",
                    "source-layer": "buildings",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 21,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "match",
                            ["get", "primary_usage_category"],
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Domestic", "#808080",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/EmergencyServices", "#D62728",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/MedicalCare", "#FF7F0E",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Education", "#2CA02C",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Non-Domestic", "#1F77B4",
                            "#808080"
                          ],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "ocgml_buildings-layer",
                    "name": "OS BHA Buildings (i.e. buildings without EPC information)",
                    "source": "ocgml_buildings",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 20,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-extrusion-color": "#303030",
                        "fill-extrusion-opacity": 0.4,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "fill-extrusion-height"],
                            ["to-number", ["get", "fill-extrusion-height"]],
                            8
                        ]
                    }
                },
                {
                    "id": "aoi-layer",
                    "name": "This layer is the area of interest, i.e. greater King's Lynn area", 
                    "source": "area-of-interest",
                    "type": "circle",
                    "treeable": false,
                    "maxzoom": 10,
                    "order": 0,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "circle-radius": ["interpolate", ["linear"], ["zoom"], 4, 25, 8, 100],
                        "circle-opacity": 0.15,
                        "circle-color": "#000000",
                        "circle-stroke-width": 0
                    }
                }
            ]
        },
        {
            "name": "Reporting Stations",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "metoffice",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=stations%3Ametoffice&outputFormat=application%2Fjson"
                },
                {
                    "id": "ea-stations",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=stations%3Ariver_stations&outputFormat=application%2Fjson"
                },
                {
                    "id": "aq-stations",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=airquality%3Aairquality&outputFormat=application%2Fjson"
                }
            ], 
            "layers": [
                {
                    "id": "airquality",
                    "name": "Airquality Stations", 
                    "source": "aq-stations",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 32,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "air_airquality", 
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "airquality_cluster",
                    "name":  "Airquality Stations",
                    "source": "aq-stations",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "ukair",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                },
                {
                    "id": "metoffice",
                    "name": "Weather Stations", 
                    "source": "metoffice",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 31,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": [
                            "match",
                            ["get", "subtype"],
                            "observation", "met_weather-obs",
                            "forecast", "met_weather-for",
                            "met_weather"
                        ],
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "metoffice_cluster",
                    "name":  "Weather Stations",
                    "source": "metoffice",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "metoffice",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                },
                {
                    "id": "ea-stations",
                    "name": "Flood Monitoring Stations", 
                    "source": "ea-stations",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 30,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": [
                            "match",
                            ["get", "type"],
                            "ea-flow", "ea_flow",
                            "ea-rainfall", "ea_rainfall",
                            "ea-temperature", "ea_temperature",
                            "ea-water-level", "ea_water-level",
                            "ea-wind", "ea_wind",
                            "floodmonitoring"
                        ],
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "ea-stations_cluster",
                    "name":  "Flood Monitoring Stations",
                    "source": "ea-stations",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "floodmonitoring",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                }
            ]
        },
        {
            "name": "Flood Warnings",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "floodwarnings_active",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:floodwarnings&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile&cql_filter=active=true"
                    ]
                },
                {
                    "id": "floodwarnings_inactive",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:floodwarnings&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile&cql_filter=active=false"
                    ]
                }
            ], 
            "layers": [
                {
                    "id": "floodwarnings",
                    "name": "Active flood warnings",
                    "source": "floodwarnings_active",
                    "source-layer": "floodwarnings",
                    "type": "fill",
                    "order": 11,
                    "layout": {
                        "visibility": "visible"
                    },
                    "text-field": ["get", "severity"],
                    "paint": {
                        "fill-color": [
                            "match",
                            ["get", "severity"],
                            "4", "#add8e6",
                            "3", "#ebc244",
                            "2", "#ff8800",
                            "1", "#c90a0a",
                            "#808080"
                          ],
                        "fill-opacity": 0.4,
                        "fill-outline-color": "#000000"
                    }
                },
                {
                    "id": "floodwarnings_outdated",
                    "name": "Inactive flood warnings",
                    "source": "floodwarnings_inactive",
                    "source-layer": "floodwarnings",
                    "type": "fill",
                    "order": 10,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-color": "#808080",
                        "fill-opacity": 0.3,
                        "fill-outline-color": "#000000"
                    }
                }
            ]
        },
        {
            "name": "Population Data",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "openpopgrid",
                    "type": "raster",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/population/wms?service=WMS&version=1.1.0&request=GetMap&layers=population:population&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=image/png&transparent=true"
                    ]
                }
            ], 
            "layers": [
                {
                    "id": "openpopgrid",
                    "type": "raster",
                    "name": "OpenPopGrid",
                    "source": "openpopgrid",
                    "minzoom": 8,
                    "order": 1,
                    "layout": {
                        "visibility": "none"
                    }
                }
            ]
        },
        {
            "name": "Network Infrastructure",
            "groups": [
                {
                    "name": "Fully operational",
                    "groups": [
                        {   

                            "name": "Water Network (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/water",
                            "sources": [
                                {
                                    "id": "water-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/gxibUm4A/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=gxibUm4A%3AWater&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/gxibUm4A/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=gxibUm4A%3ASludge&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/gxibUm4A/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=gxibUm4A%3ASewage&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                }
                            ],
                            "layers": [
                                {
                                    "id": "water-layer-bottom",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 101,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "water-layer-middle",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 102,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "water-layer-top",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 103,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-clean",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-layer-bottom",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 104,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-layer-middle",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 105,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "sludge-layer-top",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 106,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-sludge",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-layer-bottom",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 107,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-layer-middle",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 108,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "sewage-layer-top",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 109,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-sewage",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "Power Network (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/power",
                            "sources": [
                                {
                                    "id": "primary-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/power/geoserver/gxibUm4A/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=gxibUm4A%3APrimary&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/power/geoserver/gxibUm4A/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=gxibUm4A%3ASecondary&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                }
                            ],
                            "layers": [
                                {
                                    "id": "primary-layer-bottom",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 101,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#F9D813",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#F9D813",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#F9D813",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#F9D813"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "primary-layer-middle",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 102,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "primary-layer-top",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 103,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "power-primary",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#F9D813",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#F9D813",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-layer-bottom",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 104,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#F9D813",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#F9D813",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#F9D813",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#F9D813"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-layer-middle",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 105,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "secondary-layer-top",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 106,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "power-secondary",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#F9D813",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#F9D813",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                }
                            ]
                        },      
                        {
                            "name": "Connectivity (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/central",
                            "groups": [
                                {
                                    "name": "Power Network",
                                    "sources": [
                                        {
                                            "id": "power-conns",
                                            "type": "vector",
                                            "tiles": [
                                                "https://kg.cmclinnovations.com/credo/phase2/central/geoserver/gxibUm4A/wms?service=WMS&version=1.1.0&request=GetMap&layers=gxibUm4A%3APower&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                                            ]
                                        }
                                    ],
                                    "layers": [
                                        {
                                            "id": "power-to-power-core",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 100,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ]
                                            ],
                                            "paint": {
                                                "line-color": "#F9D813",
                                                "line-width": 3
                                            }
                                        },
                                        {
                                            "id": "power-to-power-arrow",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "symbol",
                                            "order": 100,
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ]
                                            ],
                                            "layout": {
                                                "visibility": "none",
                                                "icon-image": "arrow",
                                                "icon-rotate": 90,
                                                "icon-allow-overlap": true,
                                                "symbol-placement": "line",
                                                "symbol-spacing": 100,
                                                "icon-size": 0.2
                                            },
                                            "paint": {
                                                "icon-color": "#000000"
                                            }
                                        },
                                        {
                                            "id": "power-to-power-under",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 99,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ],
                                                ["<", ["to-number", ["get", "state"]], 1.0]
                                            ],
                                            "paint": {
                                                "line-width": 7,
                                                "line-color": [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ]
                                            }
                                        },
                                        {
                                            "id": "power-to-water-core",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 100,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ]
                                            ],
                                            "paint": {
                                                "line-color": "#F9D813",
                                                "line-width": 3
                                            }
                                        },
                                        {
                                            "id": "power-to-water-arrow",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "symbol",
                                            "order": 100,
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ]
                                            ],
                                            "layout": {
                                                "visibility": "none",
                                                "icon-image": "arrow",
                                                "icon-rotate": 90,
                                                "icon-allow-overlap": true,
                                                "symbol-placement": "line",
                                                "symbol-spacing": 100,
                                                "icon-size": 0.2
                                            },
                                            "paint": {
                                                "icon-color": "#000000"
                                            }
                                        },
                                        {
                                            "id": "power-to-water-under",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 99,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ],
                                                ["<", ["to-number", ["get", "state"]], 1.0]
                                            ],
                                            "paint": {
                                                "line-width": 7,
                                                "line-color": [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            ],                
                            "sources": [
                                {
                                    "id": "water-conns",
                                    "type": "vector",
                                    "tiles": [
                                        "https://kg.cmclinnovations.com/credo/phase2/central/geoserver/gxibUm4A/wms?service=WMS&version=1.1.0&request=GetMap&layers=gxibUm4A%3AWater&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                                    ]
                                }
                            ],
                            "layers": [
                                {
                                    "id": "water-to-water-core",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "line",
                                    "order": 100,
                                    "layout": {
                                        "visibility": "none"
                                    },
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"]
                                    ],
                                    "paint": {
                                        "line-color": "#86C3EB",
                                        "line-width": 3
                                    }
                                },
                                {
                                    "id": "water-to-water-arrow",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "symbol",
                                    "order": 100,
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"]
                                    ],
                                    "layout": {
                                        "visibility": "none",
                                        "icon-image": "arrow",
                                        "icon-rotate": 90,
                                        "icon-allow-overlap": true,
                                        "symbol-placement": "line",
                                        "symbol-spacing": 100,
                                        "icon-size": 0.2
                                    },
                                    "paint": {
                                        "icon-color": "#000000"
                                    }
                                },
                                {
                                    "id": "water-to-water-under",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "line",
                                    "order": 99,
                                    "layout": {
                                        "visibility": "none"
                                    },
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"],
                                        ["<", ["to-number", ["get", "state"]], 1.0]
                                    ],
                                    "paint": {
                                        "line-width": 7,
                                        "line-color": [
                                            "interpolate",
                                            [
                                                "linear"
                                            ],
                                            [
                                                "-",
                                                1.0,
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "state"
                                                    ]
                                                ]
                                            ],
                                            0.001,
                                            "#E08733",
                                            1.0,
                                            "#E08733"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Disrupted operations",
                    "groups": [
                        {   

                            "name": "Water Network (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/water",
                            "sources": [
                                {
                                    "id": "water-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/z8bigz9E/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=z8bigz9E%3AWater&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Water Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/z8bigz9E/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=z8bigz9E%3ASludge&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Sludge Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/water/geoserver/z8bigz9E/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=z8bigz9E%3ASewage&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Sewage Sites.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                }
                            ],
                            "layers": [
                                {
                                    "id": "water-layer-bottom",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 101,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "water-layer-middle",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 102,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "water-layer-top",
                                    "name": "Water Sites",
                                    "source": "water-source",
                                    "type": "symbol",
                                    "order": 103,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-clean",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-layer-bottom",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 104,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sludge-layer-middle",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 105,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "sludge-layer-top",
                                    "name": "Sludge Sites",
                                    "source": "sludge-source",
                                    "type": "symbol",
                                    "order": 106,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-sludge",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-layer-bottom",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 107,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#86C3EB",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#86C3EB",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#86C3EB",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#86C3EB"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "sewage-layer-middle",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 108,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "sewage-layer-top",
                                    "name": "Sewage Sites",
                                    "source": "sewage-source",
                                    "type": "symbol",
                                    "order": 109,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "water-sewage",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#86C3EB",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#86C3EB",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "Power Network (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/power",
                            "sources": [
                                {
                                    "id": "primary-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/power/geoserver/z8bigz9E/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=z8bigz9E%3APrimary&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Primary Substations.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-source",
                                    "type": "geojson",
                                    "data": "https://kg.cmclinnovations.com/credo/phase2/power/geoserver/z8bigz9E/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=z8bigz9E%3ASecondary&outputFormat=application%2Fjson",
                                    "cluster": true,
                                    "clusterRadius": 30,
                                    "clusterMaxZoom": 11,
                                    "clusterProperties": {
                                        "flood_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "flood_state"
                                                ]
                                            ]
                                        ],
                                        "output_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "output_state"
                                                ]
                                            ]
                                        ],
                                        "input_lowest_state": [
                                            "min",
                                            [
                                                "to-number",
                                                [
                                                    "get",
                                                    "input_lowest_state"
                                                ]
                                            ]
                                        ],
                                        "description": [
                                            "concat",
                                            [
                                                "case",
                                                [
                                                    "!=",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                "<div order='101'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #C63F3F;'>In this case, at least one location has a non-zero chance of <b>direct</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                [
                                                    "case",
                                                    [
                                                        "!=",
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    "<div order='102'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #DF6C35;'>In this case, at least one location has a non-zero chance of <b>indirect</b> output failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                    [
                                                        "case",
                                                        [
                                                            "!=",
                                                            [
                                                                "-",
                                                                1.0,
                                                                [
                                                                    "to-number",
                                                                    [
                                                                        "get",
                                                                        "input_lowest_state"
                                                                    ]
                                                                ]
                                                            ],
                                                            0.0
                                                        ],
                                                        "<div order='103'>This point represents a cluster of closely spaced Secondary Substations.<br/></br/><span style='color: #7F7F7F;'>In this case, at least one location has a non-zero chance of secondary failure.</span><br/><br/>Click to see details on the underlying individual locations.</div>",
                                                        ""
                                                    ]
                                                ]
                                            ],
                                            [
                                                "accumulated"
                                            ]
                                        ]
                                    }
                                }
                            ],
                            "layers": [
                                {
                                    "id": "primary-layer-bottom",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 101,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#F9D813",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#F9D813",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#F9D813",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#F9D813"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "primary-layer-middle",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 102,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "primary-layer-top",
                                    "name": "Primary Substations",
                                    "source": "primary-source",
                                    "type": "symbol",
                                    "order": 103,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "power-primary",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#F9D813",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#F9D813",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-layer-bottom",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 104,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ],
                                        "icon-size": [
                                            "case",
                                            [
                                                "all",
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    0.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "==",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "input_lowest_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ]
                                            ],
                                            0.65,
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        ">",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "flood_state"
                                                            ]
                                                        ],
                                                        0.0
                                                    ],
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "flood_state"
                                                        ]
                                                    ],
                                                    [
                                                        "case",
                                                        [
                                                            "<",
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ],
                                                            1.0
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "output_state"
                                                                ]
                                                            ]
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ],
                                                0.0,
                                                0.5,
                                                1.0,
                                                0.65
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            [
                                                "interpolate",
                                                [
                                                    "linear"
                                                ],
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0,
                                                "#F9D813",
                                                0.001,
                                                "#C22525",
                                                1.0,
                                                "#C22525"
                                            ],
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "output_state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.0,
                                                    "#F9D813",
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ],
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    [
                                                        "interpolate",
                                                        [
                                                            "linear"
                                                        ],
                                                        [
                                                            "-",
                                                            1.0,
                                                            [
                                                                "to-number",
                                                                [
                                                                    "get",
                                                                    "input_lowest_state"
                                                                ]
                                                            ]
                                                        ],
                                                        0.0,
                                                        "#F9D813",
                                                        0.001,
                                                        "#7E7E7E",
                                                        1.0,
                                                        "#7E7E7E"
                                                    ],
                                                    "#F9D813"
                                                ]
                                            ]
                                        ]
                                    }
                                },
                                {
                                    "id": "secondary-layer-middle",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 105,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": [
                                            "case",
                                            [
                                                ">",
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "flood_state"
                                                    ]
                                                ],
                                                0.0
                                            ],
                                            "circle",
                                            [
                                                "case",
                                                [
                                                    "<",
                                                    [
                                                        "to-number",
                                                        [
                                                            "get",
                                                            "output_state"
                                                        ]
                                                    ],
                                                    1.0
                                                ],
                                                "octagon",
                                                [
                                                    "case",
                                                    [
                                                        "<",
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "input_lowest_state"
                                                            ]
                                                        ],
                                                        1.0
                                                    ],
                                                    "square",
                                                    "circle"
                                                ]
                                            ]
                                        ]
                                    },
                                    "paint": {
                                        "icon-color": "#FFFFFF"
                                    }
                                },
                                {
                                    "id": "secondary-layer-top",
                                    "name": "Secondary Substations",
                                    "source": "secondary-source",
                                    "type": "symbol",
                                    "order": 106,
                                    "layout": {
                                        "visibility": "none",
                                        "symbol-z-order": "viewport-y",
                                        "icon-allow-overlap": false,
                                        "icon-ignore-placement": true,
                                        "icon-size": 0.55,
                                        "icon-image": "power-secondary",
                                        "text-anchor": "center",
                                        "text-allow-overlap": true,
                                        "text-ignore-placement": true,
                                        "text-font": [
                                            "Open Sans Bold"
                                        ],
                                        "text-size": 16,
                                        "text-field": "{point_count_abbreviated}"
                                    },
                                    "paint": {
                                        "icon-color": "#F9D813",
                                        "icon-opacity": [
                                            "case",
                                            [
                                                "has",
                                                "point_count"
                                            ],
                                            0.0,
                                            1.0
                                        ],
                                        "text-color": "#F9D813",
                                        "text-opacity": [
                                            "case",
                                            [
                                                "!",
                                                [
                                                    "has",
                                                    "point_count"
                                                ]
                                            ],
                                            0.0,
                                            1.0
                                        ]
                                    }
                                }
                            ]
                        },      
                        {
                            "name": "Connectivity (Synthetic)",
                            "stack": "https://kg.cmclinnovations.com/credo/phase2/central",
                            "groups": [
                                {
                                    "name": "Power Network",
                                    "sources": [
                                        {
                                            "id": "power-conns",
                                            "type": "vector",
                                            "tiles": [
                                                "https://kg.cmclinnovations.com/credo/phase2/central/geoserver/z8bigz9E/wms?service=WMS&version=1.1.0&request=GetMap&layers=z8bigz9E%3APower&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                                            ]
                                        }
                                    ],
                                    "layers": [
                                        {
                                            "id": "power-to-power-core",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 100,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ]
                                            ],
                                            "paint": {
                                                "line-color": "#F9D813",
                                                "line-width": 3
                                            }
                                        },
                                        {
                                            "id": "power-to-power-arrow",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "symbol",
                                            "order": 100,
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ]
                                            ],
                                            "layout": {
                                                "visibility": "none",
                                                "icon-image": "arrow",
                                                "icon-rotate": 90,
                                                "icon-allow-overlap": true,
                                                "symbol-placement": "line",
                                                "symbol-spacing": 100,
                                                "icon-size": 0.2
                                            },
                                            "paint": {
                                                "icon-color": "#000000"
                                            }
                                        },
                                        {
                                            "id": "power-to-power-under",
                                            "name": "Power to Power",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 99,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Primary"],
                                                    ["==", ["get", "receiver_type"], "Secondary"]
                                                ],
                                                ["<", ["to-number", ["get", "state"]], 1.0]
                                            ],
                                            "paint": {
                                                "line-width": 7,
                                                "line-color": [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ]
                                            }
                                        },
                                        {
                                            "id": "power-to-water-core",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 100,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ]
                                            ],
                                            "paint": {
                                                "line-color": "#F9D813",
                                                "line-width": 3
                                            }
                                        },
                                        {
                                            "id": "power-to-water-arrow",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "symbol",
                                            "order": 100,
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ]
                                            ],
                                            "layout": {
                                                "visibility": "none",
                                                "icon-image": "arrow",
                                                "icon-rotate": 90,
                                                "icon-allow-overlap": true,
                                                "symbol-placement": "line",
                                                "symbol-spacing": 100,
                                                "icon-size": 0.2
                                            },
                                            "paint": {
                                                "icon-color": "#000000"
                                            }
                                        },
                                        {
                                            "id": "power-to-water-under",
                                            "name": "Power to Water",
                                            "source": "power-conns",
                                            "source-layer": "Power",
                                            "type": "line",
                                            "order": 99,
                                            "layout": {
                                                "visibility": "none"
                                            },
                                            "minzoom": 12,
                                            "filter": [
                                                "all",
                                                [
                                                    "any", 
                                                    ["==", ["get", "supplier_type"], "Primary"],
                                                    ["==", ["get", "supplier_type"], "Secondary"]
                                                ],
                                                [
                                                    "any", 
                                                    ["==", ["get", "receiver_type"], "Water"],
                                                    ["==", ["get", "receiver_type"], "Sewage"]
                                                ],
                                                ["<", ["to-number", ["get", "state"]], 1.0]
                                            ],
                                            "paint": {
                                                "line-width": 7,
                                                "line-color": [
                                                    "interpolate",
                                                    [
                                                        "linear"
                                                    ],
                                                    [
                                                        "-",
                                                        1.0,
                                                        [
                                                            "to-number",
                                                            [
                                                                "get",
                                                                "state"
                                                            ]
                                                        ]
                                                    ],
                                                    0.001,
                                                    "#E08733",
                                                    1.0,
                                                    "#E08733"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            ],                
                            "sources": [
                                {
                                    "id": "water-conns",
                                    "type": "vector",
                                    "tiles": [
                                        "https://kg.cmclinnovations.com/credo/phase2/central/geoserver/z8bigz9E/wms?service=WMS&version=1.1.0&request=GetMap&layers=z8bigz9E%3AWater&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                                    ]
                                }
                            ],
                            "layers": [
                                {
                                    "id": "water-to-water-core",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "line",
                                    "order": 100,
                                    "layout": {
                                        "visibility": "none"
                                    },
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"]
                                    ],
                                    "paint": {
                                        "line-color": "#86C3EB",
                                        "line-width": 3
                                    }
                                },
                                {
                                    "id": "water-to-water-arrow",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "symbol",
                                    "order": 100,
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"]
                                    ],
                                    "layout": {
                                        "visibility": "none",
                                        "icon-image": "arrow",
                                        "icon-rotate": 90,
                                        "icon-allow-overlap": true,
                                        "symbol-placement": "line",
                                        "symbol-spacing": 100,
                                        "icon-size": 0.2
                                    },
                                    "paint": {
                                        "icon-color": "#000000"
                                    }
                                },
                                {
                                    "id": "water-to-water-under",
                                    "name": "Water Network",
                                    "source": "water-conns",
                                    "source-layer": "Water",
                                    "type": "line",
                                    "order": 99,
                                    "layout": {
                                        "visibility": "none"
                                    },
                                    "minzoom": 12,
                                    "filter": [
                                        "all",
                                        ["==", ["get", "supplier_type"], "Water"],
                                        ["==", ["get", "receiver_type"], "Water"],
                                        ["<", ["to-number", ["get", "state"]], 1.0]
                                    ],
                                    "paint": {
                                        "line-width": 7,
                                        "line-color": [
                                            "interpolate",
                                            [
                                                "linear"
                                            ],
                                            [
                                                "-",
                                                1.0,
                                                [
                                                    "to-number",
                                                    [
                                                        "get",
                                                        "state"
                                                    ]
                                                ]
                                            ],
                                            0.001,
                                            "#E08733",
                                            1.0,
                                            "#E08733"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}