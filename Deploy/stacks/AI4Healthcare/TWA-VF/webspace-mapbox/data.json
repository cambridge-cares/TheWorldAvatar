{
    "name": "All Layers",
    "groups": [
        {
            "name": "Cam-Ely-Wisbech Buildings",
            "stack": "http://174.138.27.240:3838",
            "sources": [
                {
                    "id": "cambridge-source",
                    "type": "vector",
                    "tiles": [
                        "http://174.138.27.240:3838/geoserver/the_world_avatar/wms?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar%3Acambridge_gsl&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "area-of-interest-Cambridge",
                    "type": "geojson",
                    "data": "data/aoi_Cambridge.geojson", 
                    "generateId": true
                },
                {
                    "id": "area-of-interest-Ely",
                    "type": "geojson",
                    "data": "data/aoi_Ely.geojson", 
                    "generateId": true
                },
                {
                    "id": "area-of-interest-Wisbech",
                    "type": "geojson",
                    "data": "data/aoi_Wisbech.geojson", 
                    "generateId": true
                }
            ],
            "layers": [
                {
                    "id": "cambridge-layer",
                    "name": "Cambridge-Ely-Wisbech Building",
                    "treeable": false,
                    "source": "cambridge-source",
                    "source-layer": "cambridge_gsl",
                    "type": "fill-extrusion",
                    "order": 23,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "step",
                            ["get", "building_height"],
                            "#FF0000",       
                            3.57, "#0769AD", 
                            7.14, "#0769AD", 
                            10.71, "#0769AD",
                            14.28, "#0769AD",
                            17.85, "#AD0202",
                            21.42, "#AD0202"
                        ],
                        "fill-extrusion-opacity": 0.9,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building_height"],
                            ["*", 1.0, ["to-number", ["get", "building_height"]]],
                            200
                        ]
                    }
                },
                {
                    "id": "aoi-Cambridge-layer",
                    "name": "This layer is the area of interest, i.e. greater King's Lynn area", 
                    "source": "area-of-interest-Cambridge",
                    "type": "circle",
                    "treeable": false,
                    "maxzoom": 12,
                    "order": 0,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "circle-radius": ["interpolate", ["linear"], ["zoom"], 4, 25, 8, 100],
                        "circle-opacity": 0.15,
                        "circle-color": "#000000",
                        "circle-stroke-width": 0
                    }
                },
                {
                    "id": "aoi-Ely-layer",
                    "name": "This layer is the area of interest, i.e. greater King's Lynn area", 
                    "source": "area-of-interest-Ely",
                    "type": "circle",
                    "treeable": false,
                    "maxzoom": 12,
                    "order": 0,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "circle-radius": ["interpolate", ["linear"], ["zoom"], 4, 25, 8, 100],
                        "circle-opacity": 0.15,
                        "circle-color": "#000000",
                        "circle-stroke-width": 0
                    }
                },
                {
                    "id": "aoi-Wisbech-layer",
                    "name": "This layer is the area of interest, i.e. greater King's Lynn area", 
                    "source": "area-of-interest-Wisbech",
                    "type": "circle",
                    "treeable": false,
                    "maxzoom": 12,
                    "order": 0,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "circle-radius": ["interpolate", ["linear"], ["zoom"], 4, 25, 8, 100],
                        "circle-opacity": 0.15,
                        "circle-color": "#000000",
                        "circle-stroke-width": 0
                    }
                }
            ]
        },
        {
            "name": "Kings-Lynn Buildings",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "area-of-interest",
                    "type": "geojson",
                    "data": "data/aoi_KingsLynn.geojson", 
                    "generateId": true
                },
                {
                    "id": "ocgml_buildings",
                    "type": "geojson",
                    "data": "data/buildings/os_bha_buildings.geojson"
                },
                {
                    "id": "obe_buildings",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:buildings&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "building_sales",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:transactions&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "building_values",  
                    "type": "vector",
                    "tiles": [
                        "http://165.232.172.16:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=kingslynn:marketvalues&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                }
            ], 
            "layers": [
                {
                    "id": "buildings-layer-value",
                    "name": "Property Value Estimates",
                    "source": "building_values",
                    "source-layer": "marketvalues",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 23,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "case", 
                            ["==", ["get", "price"], null], "#000000", [
                            "interpolate", ["linear"],
                            ["number", ["get", "price"]],
                            50000, "#0769AD",
                            1200000, "#AD0202"
                        ]],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "buildings-layer-sales",
                    "name": "Actual Property Sales",
                    "source": "building_sales",
                    "source-layer": "transactions",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 22,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "case", 
                            ["==", ["get", "price"], null], "#000000", [
                            "interpolate", ["linear"],
                            ["number", ["get", "price"]],
                            50000, "#0769AD",
                            1200000, "#AD0202"
                        ]],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "obe_buildings-layer-usage",
                    "name": "Buildings with usage information",
                    "source": "obe_buildings",
                    "source-layer": "buildings",
                    "type": "fill-extrusion",
                    "minzoom": 8, 
                    "order": 21,
                    "layout": {
                        "visibility": "none"
                    },
                    "paint": {
                        "fill-extrusion-color": [
                            "match",
                            ["get", "primary_usage_category"],
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Domestic", "#808080",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/EmergencyServices", "#D62728",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/MedicalCare", "#FF7F0E",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Education", "#2CA02C",
                            "https://www.theworldavatar.com/kg/ontobuiltenv/Non-Domestic", "#1F77B4",
                            "#808080"
                          ],
                        "fill-extrusion-opacity": 0.8,
                        "fill-extrusion-base": 0,
                        "fill-extrusion-height": [
                            "case",
                            ["has", "building height"],
                            ["*", 1.4, ["to-number", ["get", "building height"]]],
                            8
                        ]
                    }
                },
                {
                    "id": "aoi-layer",
                    "name": "This layer is the area of interest, i.e. greater King's Lynn area", 
                    "source": "area-of-interest",
                    "type": "circle",
                    "treeable": false,
                    "maxzoom": 12,
                    "order": 0,
                    "layout": {
                        "visibility": "visible"
                    },
                    "paint": {
                        "circle-radius": ["interpolate", ["linear"], ["zoom"], 4, 25, 8, 100],
                        "circle-opacity": 0.15,
                        "circle-color": "#000000",
                        "circle-stroke-width": 0
                    }
                }
            ]
        },
        {   "name": "GPS Tracking",
            "stack": "http://174.138.27.240:5007",
            "sources": [
                {
                    "id": "Recorded Points Sources",
                    "type": "vector",
                    "tiles": [
                        "http://174.138.27.240:5007/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar:gps_data&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                },
                {
                    "id": "Movement Trajectory Sources",
                    "type": "raster",
                    "tiles": [
                        "http://174.138.27.240:5007/geoserver/the_world_avatar/wms?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar:gps_line&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&transparent=true&format=image/png"
                    ]
                }

            ],
            "layers": [
                {
                    "id": "Recorded Points_layer",
                    "name": "Recorded Points",
                    "source": "Recorded Points Sources",
                    "source-layer": "gps_data",
                    "type": "symbol",
                    "minzoom": 6,
                    "order": 24,
                    "layout": {
                        "visibility": "none",
                        "icon-image": "gpslocation2",
                        "icon-size": 0.37,
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                },
                {
                    "id": "Movement Trajectory_layer",
                    "name": "Movement Trajectory",
                    "source": "Movement Trajectory Sources",
                    "type": "raster",
                    "minzoom": 4,
                    "order": 3,
                    "layout": {
                        "visibility": "none"
                    }
                }

            ]
        },
        {   "name": "Food Hygiene Rating",
            "stack": "http://174.138.27.240:5007",
            "sources": [
                {
                    "id": "fhr-cambridge-source",
                    "type": "vector",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "tiles": [
                        "http://174.138.27.240:5007/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar:fhr_cambridge&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
                    ]
                }
            ],
            "layers": [
                {
                    "id": "fhr-cambridge_layer",
                    "name": "FHR Cambridge",
                    "source": "fhr-cambridge-source",
                    "source-layer": "fhr_cambridge",
                    "type": "symbol",
                    "minzoom": 6,
                    "order": 24,
                    "layout": {
                        "visibility": "none",
                        "icon-image": "FoodHygieneRating",
                        "icon-size": 0.45,
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                }
            ]
        },
        {
            "name": "Reporting Stations",
            "stack": "http://165.232.172.16:3838",
            "sources": [
                {
                    "id": "metoffice",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=stations%3Ametoffice&outputFormat=application%2Fjson"
                },
                {
                    "id": "ea-stations",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=stations%3Ariverstations&outputFormat=application%2Fjson"
                },
                {
                    "id": "aq-stations",  
                    "type": "geojson",
                    "cluster": true,
                    "clusterMaxZoom": 14,
                    "clusterRadius": 100,
                    "data": "http://165.232.172.16:3838/geoserver/stations/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=airquality%3Aairquality&outputFormat=application%2Fjson"
                }
            ], 
            "layers": [
                {
                    "id": "airquality",
                    "name": "Airquality Stations", 
                    "source": "aq-stations",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 32,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "air_airquality", 
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "airquality_cluster",
                    "name":  "Airquality Stations",
                    "source": "aq-stations",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "ukair",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                },
                {
                    "id": "metoffice",
                    "name": "Weather Stations", 
                    "source": "metoffice",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 31,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": [
                            "match",
                            ["get", "subtype"],
                            "observation", "met_weather-obs",
                            "forecast", "met_weather-for",
                            "met_weather"
                        ],
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "metoffice_cluster",
                    "name":  "Weather Stations",
                    "source": "metoffice",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "metoffice",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                },
                {
                    "id": "ea-stations",
                    "name": "Flood Monitoring Stations", 
                    "source": "ea-stations",
                    "type": "symbol",
                    "filter": ["!", ["has", "point_count"]],
                    "minzoom": 4,
                    "order": 30,
                    "layout": {
                        "visibility": "visible",
                        "icon-image": [
                            "match",
                            ["get", "type"],
                            "ea-flow", "ea_flow",
                            "ea-rainfall", "ea_rainfall",
                            "ea-temperature", "ea_temperature",
                            "ea-water-level", "ea_water-level",
                            "ea-wind", "ea_wind",
                            "floodmonitoring"
                        ],
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.5, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true
                    }
                    
                },
                {
                    "id": "ea-stations_cluster",
                    "name":  "Flood Monitoring Stations",
                    "source": "ea-stations",
                    "type": "symbol",
                    "filter": ["has", "point_count"],
                    "minzoom": 4, 
                    "layout": {
                        "visibility": "visible",
                        "icon-image": "floodmonitoring",
                        "icon-size": ["interpolate", ["linear"], ["zoom"], 12, 0.52, 20, 0.65],
                        "icon-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "text-field": "{point_count_abbreviated}",
                        "text-font": ["Arial Unicode MS Regular"],
                        "text-size": 15,
                        "text-anchor": "center",
                        "text-offset": [0, 0]
                    }
                }
            ]
        },
        {   "name": "Green Space",
            "stack": "http://174.138.27.240:5007",
            "sources": [
                {
                    "id": "green-space-source",
                    "type": "raster",
                    "tiles": [
                        "http://174.138.27.240:5007/geoserver/the_world_avatar/wms?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar:forestry&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&transparent=true&format=image/png"
                    ]
                }
            ],
            "layers": [
                {
                    "id": "green-space_layer",
                    "name": "Green Space for Cambridgeshire",
                    "source": "green-space-source",
                    "type": "raster",
                    "minzoom": 4,
                    "order": 1,
                    "layout": {
                        "visibility": "visible"
                    }
                },
                {
                    "id": "green-space_layer_2",
                    "name": "Green Space for Norfolk, including King's Lynn",
                    "source": "green-space-source",
                    "type": "raster",
                    "minzoom": 4,
                    "order": 1,
                    "layout": {
                        "visibility": "visible"
                    }
                }
            ]
        },
        {   "name": "Cropmap",
            "stack": "http://174.138.27.240:5007",
            "sources": [
                {
                    "id": "cropmap-source",
                    "type": "raster",
                    "tiles": [
                        "http://174.138.27.240:5007/geoserver/the_world_avatar/wms?service=WMS&version=1.1.0&request=GetMap&layers=the_world_avatar:cropmap&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&transparent=true&format=image/png"
                    ]
                }
            ],
            "layers": [
                {
                    "id": "cropmap_layer",
                    "name": "Cropmap for Cambridgeshire",
                    "source": "cropmap-source",
                    "type": "raster",
                    "minzoom": 4,
                    "order": 2,
                    "layout": {
                        "visibility": "none"
                    }
                }
            ]
        } 
    ]
}