{
    "database": "postgres",
    "workspace": "the_world_avatar",
    "datasetDirectory": "ukpn_pylons",
    "skip": false,
    "dataSubsets": [
        {
            "type": "tabular",
            "skip": false,
            "table": "ukpn_line_styling",
            "subdirectory": "tabular"
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_overhead_lines_high_distribution",
            "subdirectory": "vector/ukpn-hv-overhead-lines-shapefile",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-nlt": [
                        "MULTILINESTRING"
                    ],
                    "-sql": [
                        "SELECT *, 'DH' AS voltage_level FROM \"ukpn-hv-overhead-lines-shapefile\""
                    ]
                }
            },
            "sql": "ALTER TABLE ukpn_overhead_lines_high_distribution ADD COLUMN IF NOT EXISTS max_voltage_kv FLOAT , ADD COLUMN IF NOT EXISTS name VARCHAR ; UPDATE ukpn_overhead_lines_high_distribution SET max_voltage_kv = CAST(REGEXP_REPLACE(betr_spann, '[^0-9\\.]+', '', 'g') AS FLOAT), name = CONCAT('UKPN Overhead Line (', dno, '-', ogc_fid, '-', voltage_level, ')');",
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_overhead_lines_low",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_overhead_lines_high_distribution/', ukpn_overhead_lines_high_distribution.ogc_fid) as iri, line_colour, line_width FROM ukpn_overhead_lines_high_distribution, ukpn_line_styling WHERE ukpn_overhead_lines_high_distribution.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "MultiLineString",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:overhead-lines"
            }
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_overhead_lines_low_distribution",
            "subdirectory": "vector/ukpn-lv-overhead-lines-shapefile",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-sql": [
                        "SELECT *, 'DL' AS voltage_level, 1.0 AS max_voltage_kv FROM \"ukpn-lv-overhead-lines-shapefile\""
                    ]
                }
            },
            "sql": "ALTER TABLE ukpn_overhead_lines_low_distribution ADD COLUMN IF NOT EXISTS name VARCHAR ; UPDATE ukpn_overhead_lines_low_distribution SET name = CONCAT('UKPN Overhead Line (', dno, '-', ogc_fid, '-', voltage_level, ')');",
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_overhead_lines_low_distribution",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_overhead_lines_low_distribution/', ukpn_overhead_lines_low_distribution.ogc_fid) as iri, line_colour, line_width FROM ukpn_overhead_lines_low_distribution, ukpn_line_styling WHERE ukpn_overhead_lines_low_distribution.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "MultiLineString",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:overhead-lines"
            }
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_poles_towers_medium",
            "subdirectory": "vector/ukpn-33kv-poles-towers",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-sql": [
                        "SELECT *, 'M' AS voltage_level, 33.0 AS max_voltage_kv, CONCAT('UKPN Tower (', SUBSTR(system_fl, 1, 3), '-', poleno, '-M)') AS name FROM \"ukpn-33kv-poles-towers\""
                    ]
                }
            },
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_poles_towers_medium",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_poles_towers_medium/', ukpn_poles_towers_medium.ogc_fid) as iri, pylon_icon AS icon, icon_size FROM ukpn_poles_towers_medium, ukpn_line_styling WHERE ukpn_poles_towers_medium.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "Point",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:poles-towers"
            }
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_overhead_lines_medium",
            "subdirectory": "vector/33kv-overhead-lines",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-nlt": [
                        "MULTILINESTRING"
                    ],
                    "-sql": [
                        "SELECT *, 'M' AS voltage_level, 33.0 AS max_voltage_kv, CONCAT('UKPN Overhead Line (', cmr, '-M)') AS name FROM \"33kv-overhead-lines\""
                    ]
                }
            },
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_overhead_lines_medium",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_overhead_lines_medium/', ukpn_overhead_lines_medium.ogc_fid) as iri, line_colour, line_width FROM ukpn_overhead_lines_medium, ukpn_line_styling WHERE ukpn_overhead_lines_medium.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "MultiLineString",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:overhead-lines"
            }
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_poles_towers_high",
            "subdirectory": "vector/132kv-poles-towers",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-sql": [
                        "SELECT *, 'H' AS voltage_level, 132.0 AS max_voltage_kv, CONCAT('UKPN Tower (', SUBSTR(sap_functi, 1, 3), '-', entityid, '-H)') AS name  FROM \"132kv-poles-towers\""
                    ]
                }
            },
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_poles_towers_high",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_poles_towers_high/', ukpn_poles_towers_high.ogc_fid) as iri, pylon_icon AS icon, icon_size FROM ukpn_poles_towers_high, ukpn_line_styling WHERE ukpn_poles_towers_high.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "Point",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:poles-towers"
            }
        },
        {
            "type": "vector",
            "skip": false,
            "table": "ukpn_overhead_lines_high",
            "subdirectory": "vector/132kv-overhead-lines",
            "ogr2ogrOptions": {
                "layerCreationOptions": {
                    "GEOMETRY_NAME": "wkb_geometry"
                },
                "otherOptions": {
                    "-nlt": [
                        "MULTILINESTRING"
                    ],
                    "-sql": [
                        "SELECT *, 'H' AS voltage_level, 132.0 AS max_voltage_kv, CONCAT('UKPN Overhead Line (', cmr, '-H)') AS name FROM \"132kv-overhead-lines\""
                    ]
                }
            },
            "geoServerSettings": {
                "virtualTable": {
                    "name": "ukpn_overhead_lines_high",
                    "sql": "SELECT wkb_geometry, name, CONCAT('http://theworldavatar.com/ontology/ontopower/ontopower.owl#ukpn_overhead_lines_high/', ukpn_overhead_lines_high.ogc_fid) as iri, line_colour, line_width FROM ukpn_overhead_lines_high, ukpn_line_styling WHERE ukpn_overhead_lines_high.voltage_level = ukpn_line_styling.voltage_level",
                    "escapeSql": false,
                    "geometry": {
                        "name": "wkb_geometry",
                        "type": "MultiLineString",
                        "srid": 4326
                    }
                },
                "defaultStyle": "the_world_avatar:overhead-lines"
            }
        }
    ],
    "mappings": [
        "ukpn_ontop.obda"
    ],
    "styles": [
        {
            "name": "poles-towers",
            "file": "poles-towers.sld"
        },
        {
            "name": "overhead-lines",
            "file": "overhead-lines.sld"
        }
    ],
    "staticGeoServerData": {
        "iconsDir": "icons"
    }
}