SELECT
    bp."ogc_fid",
    bp."SiteFunctionalLocation",
    bp."LicenceArea",
    bp."SiteName" as name,
    bp."SiteType",
    bp."SiteVoltage",
    bp."ESQCROverallRisk",
    bp."GridRef",
    bp."SiteAssetCount",
    bp."PowerTransformerCount",
    bp."ElectricalAssetCount",
    bp."CivilAssetCount",
    bp."Longitude",
    bp."Latitude",
    bp."Street",
    bp."Suburb",
    bp."TownCity",
    bp."County",
    bp."PostCode",
    bp."YearCommissioned",
    bp."DateCommissioned",
    bp."SiteClassification",
    bp."AssessmentDate",
    bp."Last_Report",
    bp."CalculatedResistance",
    bp."MeasuredResistance.Ohm.",
    bp."Next_AssessmentDate",
    bp."Easting",
    bp."Northing",
    bp."transratingwinter",
    bp."transratingsummer",
    bp."reversepower",
    bp."maxdemandsummer",
    bp."maxdemandwinter",
    bp."Spatial Coordinates",
    bp."local_authority",
    bp."local_authority_code",
    bp."geom",
    bp."closest_edge",
    bp."source",
    bp."target",
    bp."closest_node",
    bp."source_distance",
    bp."target_distance",
    t.Seq,
    t.node,
    w.the_geom
FROM
    "tsp" AS t
INNER JOIN
    "routing_ways_vertices_pgr" AS w ON t."node" = w."id"
INNER JOIN
    "grid_primary_site" AS bp ON bp."closest_node" = t."node"
