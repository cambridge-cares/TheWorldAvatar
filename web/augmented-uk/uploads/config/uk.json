{
  "name": "Augmented UK",
  "groups": [
    {
      "name": "Regions",
      "expanded": false,
      "sources": [
        {
          "id": "gb-countries-source",
          "type": "vector",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:countries_gb&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        },
        {
          "id": "ni-countries-source",
          "type": "vector",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:countries_ni&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        },
        {
          "id": "gb-counties-source",
          "type": "vector",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:counties_gb&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        },
        {
          "id": "ni-counties-source",
          "type": "vector",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:counties_ni&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        }
      ],
      "layers": [
        {
          "id": "gb-countries-layer",
          "name": "Countries",
          "source": "gb-countries-source",
          "source-layer": "countries_gb",
          "grouping": "Countries",
          "interactions": "hover-only",
          "hover": [0.75,0.45],
          "type": "fill",
          "paint": {
            "fill-color": "#31ff61",
            "fill-outline-color" : "#0F4D1D"
          }
        },
        {
          "id": "ni-countries-layer",
          "name": "Countries",
          "source": "ni-countries-source",
          "source-layer": "countries_ni",
          "grouping": "Countries",
          "interactions": "hover-only",
          "hover": [0.75,0.45],
          "type": "fill",
          "paint": {
            "fill-color": "#31ff61",
            "fill-outline-color" : "#0F4D1D"
          }
        },
        {
          "id": "gb-counties-layer",
          "name": "Ceremonial counties",
          "source": "gb-counties-source",
          "source-layer": "counties_gb",
          "grouping": "Ceremonial counties",
          "interactions": "hover-only",
          "type": "fill",
          "hover": [0.95,0.45],
          "paint": {
            "fill-color": "#2edaff",
            "fill-outline-color" : "#0E414D"
          }
        },
        {
          "id": "ni-counties-layer",
          "name": "Ceremonial counties",
          "source": "ni-counties-source",
          "source-layer": "counties_ni",
          "grouping": "Ceremonial counties",
          "interactions": "hover-only",
          "type": "fill",
          "hover": [0.95,0.45],
          "paint": {
            "fill-color": "#2edaff",
            "fill-outline-color" : "#0E414D"
          }
        }
      ]
    },
    {
      "name": "Population data",
      "expanded": false,
      "sources": [
        {
          "id": "uk-population-source",
          "type": "raster",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:population&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&transparent=true&format=image/png"
          ]
        }
      ],
      "layers": [
        {
          "id": "uk-population-layer",
          "name": "UK population count",
          "source": "uk-population-source",
          "type": "raster"
        }
      ]
    },
    {
      "name": "Forestry",
      "stack": "https://theworldavatar.io/demos/uk",
      "expanded": false,
      "sources": [
        {
          "id": "forestry",
          "type": "vector",
          "tiles": [
            "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:forestry&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        }
      ],
      "layers": [
        {
          "id": "forestry-all",
          "type": "fill",
          "name": "All Forestry",
          "grouping": "Default",
          "source": "forestry",
          "source-layer": "forestry",
          "minzoom": 8,
          "paint": {
            "fill-color": ["get", "colour"]
          },
          "layout": {
            "visibility": "none"
          }
        }, {
          "id": "forestry-woodland",
          "type": "fill",
          "name": "Woodland",
          "grouping": "Woodland",
          "source": "forestry",
          "source-layer": "forestry",
          "filter": ["==", "category", "Woodland"],
          "minzoom": 8,
          "paint": {
            "fill-color": ["get", "colour"]
          },
          "layout": {
            "visibility": "none"
          }
        },
        {
          "id": "forestry-non-woodland",
          "type": "fill",
          "name": "Non-Woodland",
          "grouping": "Non-Woodland",
          "source": "forestry",
          "source-layer": "forestry",
          "filter": ["==", "category", "Non woodland"],
          "minzoom": 8,
          "paint": {
            "fill-color": ["get", "colour"]
          },
          "layout": {
            "visibility": "none"
          }
        }
      ]
    },
    {
      "name": "Power network",
      "stack": "https://theworldavatar.io/demos/uk",
      "groups": [
        {
          "name": "Generation",
          "stack": "https://theworldavatar.io/demos/uk",
          "expanded": false,
          "sources": [
            {
              "id": "uk-power-source",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:dukes_2023&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "uk-power-radius-source",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/twa/wms?service=WMS&version=1.1.0&request=GetMap&layers=twa:dukes_2023_pop&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            }
          ],
          "layers": [
            {
              "id": "power_renewable_layer",
              "name": "Renewable",
              "source": "uk-power-source",
              "source-layer": "dukes_2023",
              "type": "circle",
              "filter": [
                "!",
                ["in", ["get", "type"], ["literal", ["Fossil Fuel", "Nuclear"]]]
              ],
              "layout": {
                "visibility": "visible",
                "circle-sort-key": ["*", -1.0, ["get", "capacity"]]
              },
              "paint": {
                "circle-stroke-color": "#000000",
                "circle-stroke-width": 1,
                "circle-opacity": [
                  "case",
                  ["==", ["get", "iri"], "[HOVERED-IRI]"],
                  1.0,
                  0.65
                ],
                "circle-radius": [
                  "interpolate",
                  ["linear"],
                  ["get", "capacity"],
                  0,
                  4,
                  100,
                  8,
                  1000,
                  14,
                  2250,
                  28
                ],
                "circle-color": [
                  "case",
                  ["==", ["get", "primary_fuel"], "Biomass"],
                  "#66ff66",
                  ["==", ["get", "primary_fuel"], "MSW"],
                  "#006600",
                  ["==", ["get", "primary_fuel"], "Wind"],
                  "#99ccff",
                  ["==", ["get", "primary_fuel"], "Hydro"],
                  "#006699",
                  ["==", ["get", "primary_fuel"], "Pumped hydro"],
                  "#006699",
                  ["==", ["get", "primary_fuel"], "Solar"],
                  "#ffff99",
                  "#FFFFFF"
                ]
              }
            },
            {
              "id": "power_fossil_layer",
              "name": "Non-renewable",
              "source": "uk-power-source",
              "source-layer": "dukes_2023",
              "type": "circle",
              "filter": [
                "in",
                ["get", "type"],
                ["literal", ["Fossil Fuel", "Nuclear"]]
              ],
              "layout": {
                "visibility": "visible",
                "circle-sort-key": ["*", -1.0, ["get", "capacity"]]
              },
              "paint": {
                "circle-stroke-color": "#000000",
                "circle-stroke-width": 1,
                "circle-opacity": [
                  "case",
                  ["==", ["get", "iri"], "[HOVERED-IRI]"],
                  1.0,
                  0.65
                ],
                "circle-radius": [
                  "interpolate",
                  ["linear"],
                  ["get", "capacity"],
                  0,
                  4,
                  100,
                  8,
                  1000,
                  14,
                  2250,
                  28
                ],
                "circle-color": [
                  "case",
                  ["==", ["get", "primary_fuel"], "Diesel/Gas Oil"],
                  "#cccccc",
                  ["==", ["get", "primary_fuel"], "Coal"],
                  "#333333",
                  ["==", ["get", "primary_fuel"], "Sour Gas"],
                  "#ff9999",
                  ["==", ["get", "primary_fuel"], "Natural Gas"],
                  "#660000",
                  ["==", ["get", "primary_fuel"], "Nuclear"],
                  "#999900",
                  "#FFFFFF"
                ]
              }
            },
            {
              "id": "power_renewable_radius_layer",
              "name": "Renewable",
              "source": "uk-power-radius-source",
              "source-layer": "dukes_2023_pop",
              "order": -1,
              "minzoom": 9,
              "treeable": false,
              "clickable": false,
              "type": "fill",
              "filter": [
                "all",
                ["==", ["get", "iri"], "[SELECTED-IRI]"],
                [
                  "!",
                  [
                    "in",
                    ["get", "type"],
                    ["literal", ["Fossil Fuel", "Nuclear"]]
                  ]
                ]
              ],
              "layout": {
                "visibility": "visible"
              },
              "paint": {
                "fill-outline-color": "#000000",
                "fill-color": "#000000",
                "fill-opacity": 0.1
              }
            },
            {
              "id": "power_fossil_radius_layer",
              "name": "Non-renewable",
              "source": "uk-power-radius-source",
              "source-layer": "dukes_2023_pop",
              "order": -1,
              "minzoom": 9,
              "treeable": false,
              "clickable": false,
              "type": "fill",
              "filter": [
                "all",
                ["==", ["get", "iri"], "[SELECTED-IRI]"],
                ["in", ["get", "type"], ["literal", ["Fossil Fuel", "Nuclear"]]]
              ],
              "layout": {
                "visibility": "visible"
              },
              "paint": {
                "fill-outline-color": "#000000",
                "fill-color": "#000000",
                "fill-opacity": 0.1
              }
            }
          ]
        },
        {
          "name": "National Grid",
          "stack": "https://theworldavatar.io/demos/uk",
          "expanded": false,
          "sources": [
            {
              "id": "national-grid-poles",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ng_poles&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "national-grid-towers",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ng_towers&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "substations-points",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ng_substations&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "national-grid-overhead-lines",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ng_overhead_lines&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "national-grid-cables",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ng_underground_cables&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            }
          ],
          "layers": [
            {
              "id": "national-grid-poles",
              "type": "symbol",
              "name": "Poles",
              "source": "national-grid-poles",
              "source-layer": "ng_poles",
              "minzoom": 8,
              "layout": {
                "visibility": "none",
                "icon-allow-overlap": true,
                "icon-ignore-placement": true,
                "icon-image": "pylon_medium_icon",
                "icon-size": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  12,
                  0.1,
                  16,
                  0.66
                ]
              }
            },
            {
              "id": "national-grid-towers",
              "type": "symbol",
              "name": "Towers",
              "source": "national-grid-towers",
              "source-layer": "ng_towers",
              "layout": {
                "visibility": "none",
                "icon-allow-overlap": true,
                "icon-ignore-placement": true,
                "icon-image": ["get", "icon"],
                "icon-size": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  5,
                  0.02,
                  12,
                  0.1,
                  16,
                  0.66
                ]
              }
            },
            {
              "id": "substations-points",
              "type": "symbol",
              "name": "Substations",
              "source": "substations-points",
              "source-layer": "ng_substations",
              "layout": {
                "visibility": "none",
                "icon-allow-overlap": true,
                "icon-ignore-placement": true,
                "icon-image": "substation_icon",
                "icon-size": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  5,
                  0.15,
                  12,
                  0.33,
                  16,
                  0.75
                ]
              }
            },
            {
              "id": "national-grid-overhead-lines",
              "type": "line",
              "name": "Overhead lines",
              "source": "national-grid-overhead-lines",
              "minzoom": 8,
              "source-layer": "ng_overhead_lines",
              "layout": {
                "visibility": "none"
              },
              "paint": {
                "line-color": ["get", "line_colour"],
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            },
            {
              "id": "national-grid-cables-outline",
              "type": "line",
              "name": "Underground cables",
              "source": "national-grid-cables",
              "minzoom": 8,
              "source-layer": "ng_underground_cables",
              "layout": {
                "visibility": "none"
              },
              "paint": {
                "line-color": "#895a5a",
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            }
          ]
        },
        {
          "name": "UK Power Networks",
          "stack": "https://theworldavatar.io/demos/uk",
          "expanded": false,
          "sources": [
            {
              "id": "high-overhead-lines",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_overhead_lines_high&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "medium-overhead-lines",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_overhead_lines_medium&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "high-distribution-overhead-lines",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_overhead_lines_high_distribution&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "low-distribution-overhead-lines",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_overhead_lines_low_distribution&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "high-poles-towers",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_poles_towers_high&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            },
            {
              "id": "medium-poles-towers",
              "type": "vector",
              "tiles": [
                "https://theworldavatar.io/demos/uk/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:ukpn_poles_towers_medium&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
              ]
            }
          ],
          "layers": [
            {
              "id": "high-overhead-lines",
              "type": "line",
              "name": "High voltage OHL",
              "source": "high-overhead-lines",
              "source-layer": "ukpn_overhead_lines_high",
              "minzoom": 8,
              "paint": {
                "line-color": "#9E151A",
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            },
            {
              "id": "medium-overhead-lines",
              "type": "line",
              "name": "Medium voltage OHL",
              "source": "medium-overhead-lines",
              "source-layer": "ukpn_overhead_lines_medium",
              "minzoom": 8,
              "paint": {
                "line-color": "#DE5806",
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            },
            {
              "id": "high-distribution-overhead-lines",
              "type": "line",
              "name": "High distribution voltage OHL",
              "source": "high-distribution-overhead-lines",
              "source-layer": "ukpn_overhead_lines_high_distribution",
              "minzoom": 8,
              "paint": {
                "line-color": "#9E151A",
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            },
            {
              "id": "low-distribution-overhead-lines",
              "type": "line",
              "name": "Low distribution voltage OHL",
              "source": "low-distribution-overhead-lines",
              "source-layer": "ukpn_overhead_lines_low_distribution",
              "minzoom": 8,
              "paint": {
                "line-color": "#FCE446",
                "line-width": [
                  "to-number",
                  ["slice", ["get", "line_width"], 0, -1]
                ]
              }
            },
            {
              "id": "high-poles-towers",
              "type": "symbol",
              "name": "High voltage pole towers",
              "source": "high-poles-towers",
              "source-layer": "ukpn_poles_towers_high",
              "minzoom": 8,
              "layout": {
                "icon-allow-overlap": true,
                "icon-ignore-placement": true,
                "icon-image": "pylon_high_icon",
                "icon-size": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  5,
                  0.02,
                  12,
                  0.1,
                  16,
                  0.66
                ]
              }
            },
            {
              "id": "medium-poles-towers",
              "type": "symbol",
              "name": "Medium pole towers",
              "source": "medium-poles-towers",
              "source-layer": "ukpn_poles_towers_medium",
              "minzoom": 8,
              "layout": {
                "icon-allow-overlap": true,
                "icon-ignore-placement": true,
                "icon-image": "pylon_medium_icon",
                "icon-size": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  5,
                  0.02,
                  12,
                  0.1,
                  16,
                  0.66
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Power Network",
      "stack": "https://theworldavatar.io/demos/credo-ofwat/power",
      "sources": [
        {
          "id": "Secondary_Substation-source",
          "type": "geojson",
          "data": "https://theworldavatar.io/demos/credo-ofwat/power/geoserver/Zvoh7ZsC/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=Zvoh7ZsC%3ASecondary_Substation&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 30,
          "clusterMaxZoom": 11,
          "clusterProperties": {
            "highest_internal_failure_state": [
              "max",
              [
                "-",
                [
                  "to-number",
                  [
                    "get",
                    "highest_internal_failure_state"
                  ]
                ],
                [
                  "case",
                  [
                    "==",
                    [
                      "to-number",
                      [
                        "get",
                        "time"
                      ]
                    ],
                    [
                      "to-number",
                      "1"
                    ]
                  ],
                  0,
                  1
                ]
              ]
            ],
            "lowest_output_state": [
              "min",
              [
                "+",
                [
                  "to-number",
                  [
                    "get",
                    "lowest_output_state"
                  ]
                ],
                [
                  "case",
                  [
                    "==",
                    [
                      "to-number",
                      [
                        "get",
                        "time"
                      ]
                    ],
                    [
                      "to-number",
                      "1"
                    ]
                  ],
                  0,
                  1
                ]
              ]
            ],
            "lowest_input_state": [
              "min",
              [
                "+",
                [
                  "to-number",
                  [
                    "get",
                    "lowest_input_state"
                  ]
                ],
                [
                  "case",
                  [
                    "==",
                    [
                      "to-number",
                      [
                        "get",
                        "time"
                      ]
                    ],
                    [
                      "to-number",
                      "1"
                    ]
                  ],
                  0,
                  1
                ]
              ]
            ],
            "time": [
              "to-number",
              "1"
            ],
            "cluster_count": [
              "+",
              [
                "case",
                [
                  "==",
                  [
                    "to-number",
                    [
                      "get",
                      "time"
                    ]
                  ],
                  [
                    "to-number",
                    "1"
                  ]
                ],
                1,
                0
              ]
            ],
            "name": [
              [
                "case",
                [
                  "==",
                  [
                    "to-number",
                    [
                      "get",
                      "time"
                    ]
                  ],
                  [
                    "to-number",
                    "1"
                  ]
                ],
                [
                  "case",
                  [
                    "!=",
                    [
                      "get",
                      "name"
                    ],
                    [
                      "accumulated"
                    ]
                  ],
                  "Multiple locations",
                  [
                    "accumulated"
                  ]
                ],
                [
                  "get",
                  "name"
                ]
              ],
              [
                "get",
                "name"
              ]
            ],
            "iri": [
              [
                "concat",
                [
                  "get",
                  "iri"
                ],
                ",",
                [
                  "accumulated"
                ]
              ],
              [
                "get",
                "iri"
              ]
            ],
            "description": [
              [
                "case",
                [
                  "==",
                  [
                    "to-number",
                    [
                      "get",
                      "time"
                    ]
                  ],
                  [
                    "to-number",
                    "1"
                  ]
                ],
                [
                  "case",
                  [
                    "!=",
                    [
                      "get",
                      "description"
                    ],
                    [
                      "accumulated"
                    ]
                  ],
                  "This point represents a cluster of closely spaced secondary substations.",
                  [
                    "accumulated"
                  ]
                ],
                [
                  "get",
                  "description"
                ]
              ],
              [
                "get",
                "description"
              ]
            ]
          }
        }
      ],
      "layers": [
        {
          "id": "Secondary_Substation-layer-bottom",
          "name": "Secondary Substations",
          "source": "Secondary_Substation-source",
          "type": "symbol",
          "order": 10,
          "clickable": false,
          "filter": [
            "all",
            [
              "==",
              [
                "get",
                "time"
              ],
              [
                "to-number",
                "1"
              ]
            ],
            [
              "any",
              [
                "!",
                [
                  "has",
                  "cluster_count"
                ]
              ],
              [
                ">",
                [
                  "get",
                  "cluster_count"
                ],
                0
              ]
            ]
          ],
          "layout": {
            "symbol-z-order": "viewport-y",
            "icon-allow-overlap": true,
            "icon-image": [
              "case",
              [
                "all",
                [
                  ">",
                  [
                    "to-number",
                    [
                      "get",
                      "highest_internal_failure_state"
                    ]
                  ],
                  0.5
                ],
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ]
              ],
              "circle",
              [
                "case",
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ],
                "octagon",
                [
                  "case",
                  [
                    "any",
                    [
                      "<",
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ],
                      0.5
                    ],
                    [
                      ">",
                      [
                        "to-number",
                        [
                          "get",
                          "highest_internal_failure_state"
                        ]
                      ],
                      0.5
                    ]
                  ],
                  "square",
                  "circle"
                ]
              ]
            ],
            "icon-size": [
              "case",
              [
                "all",
                [
                  "<=",
                  [
                    "to-number",
                    [
                      "get",
                      "highest_internal_failure_state"
                    ]
                  ],
                  0.5
                ],
                [
                  ">=",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ],
                [
                  ">=",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_input_state"
                    ]
                  ],
                  0.5
                ]
              ],
              0.55,
              [
                "interpolate",
                [
                  "linear"
                ],
                [
                  "case",
                  [
                    ">",
                    [
                      "to-number",
                      [
                        "get",
                        "highest_internal_failure_state"
                      ]
                    ],
                    0.5
                  ],
                  [
                    "to-number",
                    [
                      "get",
                      "highest_internal_failure_state"
                    ]
                  ],
                  [
                    "case",
                    [
                      "<",
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ],
                      0.5
                    ],
                    [
                      "-",
                      1.0,
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_output_state"
                        ]
                      ]
                    ],
                    [
                      "-",
                      1.0,
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ]
                    ]
                  ]
                ],
                0.0,
                0.55,
                1.0,
                0.55
              ]
            ]
          },
          "paint": {
            "icon-color": [
              "case",
              [
                "all",
                [
                  ">",
                  [
                    "to-number",
                    [
                      "get",
                      "highest_internal_failure_state"
                    ]
                  ],
                  0.5
                ],
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ]
              ],
              [
                "interpolate",
                [
                  "linear"
                ],
                [
                  "to-number",
                  [
                    "get",
                    "highest_internal_failure_state"
                  ]
                ],
                0.0,
                "#F9D813",
                0.001,
                "#FF3333",
                1.0,
                "#FF3333"
              ],
              [
                "case",
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ],
                [
                  "interpolate",
                  [
                    "linear"
                  ],
                  [
                    "-",
                    1.0,
                    [
                      "to-number",
                      [
                        "get",
                        "lowest_output_state"
                      ]
                    ]
                  ],
                  0.0,
                  "#F9D813",
                  0.001,
                  "#FFAB57",
                  1.0,
                  "#FFAB57"
                ],
                [
                  "case",
                  [
                    "any",
                    [
                      ">",
                      [
                        "to-number",
                        [
                          "get",
                          "highest_internal_failure_state"
                        ]
                      ],
                      0.5
                    ],
                    [
                      "<",
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ],
                      0.5
                    ]
                  ],
                  [
                    "interpolate",
                    [
                      "linear"
                    ],
                    [
                      "-",
                      1.0,
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ]
                    ],
                    0.0,
                    "#F9D813",
                    0.001,
                    "#A8A8A8",
                    1.0,
                    "#A8A8A8"
                  ],
                  "#F9D813"
                ]
              ]
            ]
          }
        },
        {
          "id": "Secondary_Substation-layer-middle",
          "name": "Secondary Substations",
          "source": "Secondary_Substation-source",
          "type": "symbol",
          "order": 11,
          "clickable": false,
          "filter": [
            "all",
            [
              "==",
              [
                "get",
                "time"
              ],
              [
                "to-number",
                "1"
              ]
            ],
            [
              "any",
              [
                "!",
                [
                  "has",
                  "cluster_count"
                ]
              ],
              [
                ">",
                [
                  "get",
                  "cluster_count"
                ],
                0
              ]
            ]
          ],
          "layout": {
            "symbol-z-order": "viewport-y",
            "icon-allow-overlap": true,
            "icon-size": 0.45,
            "icon-image": [
              "case",
              [
                "all",
                [
                  ">",
                  [
                    "to-number",
                    [
                      "get",
                      "highest_internal_failure_state"
                    ]
                  ],
                  0.5
                ],
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ]
              ],
              "circle",
              [
                "case",
                [
                  "<",
                  [
                    "to-number",
                    [
                      "get",
                      "lowest_output_state"
                    ]
                  ],
                  0.5
                ],
                "octagon",
                [
                  "case",
                  [
                    "any",
                    [
                      "<",
                      [
                        "to-number",
                        [
                          "get",
                          "lowest_input_state"
                        ]
                      ],
                      0.5
                    ],
                    [
                      ">",
                      [
                        "to-number",
                        [
                          "get",
                          "highest_internal_failure_state"
                        ]
                      ],
                      0.5
                    ]
                  ],
                  "square",
                  "circle"
                ]
              ]
            ]
          },
          "paint": {
            "icon-color": "#FFFFFF"
          }
        },
        {
          "id": "Secondary_Substation-layer-top",
          "name": "Secondary Substations",
          "source": "Secondary_Substation-source",
          "type": "symbol",
          "order": 12,
          "filter": [
            "all",
            [
              "==",
              [
                "get",
                "time"
              ],
              [
                "to-number",
                "1"
              ]
            ],
            [
              "any",
              [
                "!",
                [
                  "has",
                  "cluster_count"
                ]
              ],
              [
                ">",
                [
                  "get",
                  "cluster_count"
                ],
                0
              ]
            ]
          ],
          "layout": {
            "symbol-z-order": "viewport-y",
            "icon-allow-overlap": true,
            "icon-size": 0.5,
            "icon-image": "power-secondary",
            "text-anchor": "center",
            "text-allow-overlap": true,
            "text-ignore-placement": true,
            "text-font": [
              "Open Sans Bold"
            ],
            "text-size": 16,
            "text-field": [
              "to-string",
              [
                "get",
                "cluster_count"
              ]
            ]
          },
          "paint": {
            "icon-color": "#F9D813",
            "icon-opacity": [
              "case",
              [
                "all",
                [
                  "has",
                  "cluster_count"
                ],
                [
                  ">",
                  [
                    "get",
                    "cluster_count"
                  ],
                  1
                ]
              ],
              0.0,
              1.0
            ],
            "text-color": "#F9D813",
            "text-opacity": [
              "case",
              [
                "any",
                [
                  "!",
                  [
                    "has",
                    "cluster_count"
                  ]
                ],
                [
                  "<=",
                  [
                    "get",
                    "cluster_count"
                  ],
                  1
                ]
              ],
              0.0,
              1.0
            ]
          }
        }
      ]
    },
    {
      "name": "Street Lighting",
      "stack": "http://localhost:3838",
      "expanded": false,
      "sources": [
        {
          "id": "street-lights-cambridge",
          "type": "geojson",
          "data": 
          "http://localhost:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_cambridge_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
        },
        {
          "id": "street-lights-york",
          "type": "geojson",
          "data": 
            "http://localhost:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_york_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
        },
        {
          "id": "street-lights-pk",
          "type": "geojson",
          "data": 
            "http://localhost:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_pk_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
        },
        {
          "id": "street-lights-kl",
          "type": "geojson",
          "data": "http://nash:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_kl_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
      },
        {
          "id": "street-lights-camden",
          "type": "geojson",
          "data": 
            "http://localhost:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_camden_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
        },
        {
          "id": "street-lights-bradford",
          "type": "geojson",
          "data": 
            "http://localhost:3838/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=street_lighting_bradford_table&outputFormat=application%2Fjson",
          "cluster": true,
          "clusterRadius": 100,
          "clusterMaxZoom": 15
        }
      ],
      "layers": [
        {
          "id": "street-lights-cambridge",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-cambridge",
          "filter":["!",["has","point_count"]],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_cambridge",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-cambridge",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_cambridge",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-cambridge",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      },
        {
          "id": "street-lights-york",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-york",
          "filter":["!",["has","point_count"]],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_york",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-york",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_york",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-york",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      },
        {
          "id": "street-lights-pk",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-pk",
          "filter":["!",["has","point_count"]],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_pk",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-pk",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_pk",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-pk",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      },
      
        {
          "id": "street-lights-camden",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-camden",
          "filter":["!",["has","point_count"]],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_camden",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-camden",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_camden",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-camden",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      },
        {
          "id": "street-lights-kl",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-kl",
          "filter":["all",
          
          ["!",["has","point_count"]],
          ["==",["get", "status"],0.0]
        ],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "failed-street-lights-kl",
          "type": "symbol",
          "name": "Failed Lights",
          "source": "street-lights-kl",
          "filter":["all",
          ["!",["has","point_count"]],
          ["==",["get", "status"],1.0]
          ],

          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light_failed",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_kl",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-kl",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_kl",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-kl",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      },
        {
          "id": "street-lights-bradford",
          "type": "symbol",
          "name": "Lights",
          "source": "street-lights-bradford",
          "filter":["!",["has","point_count"]],
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "street_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.04
            ]
          }
        },
        {
          "id": "clusters_bradford",
          "name": "Lights",
          "type": "circle",
          "source": "street-lights-bradford",
          "filter": true,
          "paint": {
            "circle-color": [
              "step",
              ["get", "point_count"],
              "#51bbd6",
              100,
              "#f1f075",
              750,
              "#f28cb1"
          ],
              "circle-radius": 
              [
                "step",
                ["get", "point_count"],
                12.5,
                100,
                15,
                750,
                17.5
            ]
          }
      },
      {
          "id": "cluster-count_bradford",
          "name": "Lights",
          "type": "symbol",
          "source": "street-lights-bradford",
          "filter": [
              "has",
              "point_count"
          ],
          "layout": {
              "text-field": [
                  "get",
                  "point_count_abbreviated"
              ],
              "text-font": [
                  "DIN Offc Pro Medium",
                  "Arial Unicode MS Bold"
              ],
              "text-size": 15
          }
      }
      ]
    },
    {
      "name": "Traffic Lighting",
      "stack": "http://localhost:3838",
      "expanded": false,
      "sources": [
        {
          "id": "traffic-lights-leeds",
          "type": "vector",
          "tiles": [
            "http://localhost:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:traffic_lighting_leeds_table&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        },
        {
          "id": "traffic-lights-york_traffic",
          "type": "vector",
          "tiles": [
            "http://localhost:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:traffic_lighting_york_traffic_table&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        }
      ],
      "layers": [
        {
          "id": "traffic-lights-leeds",
          "type": "symbol",
          "name": "Lights",
          "source": "traffic-lights-leeds",
          "source-layer": "traffic_lighting_leeds_table",
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "traffic_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.025
            ]
          }
        },
        {
          "id": "traffic-lights-york_traffic",
          "type": "symbol",
          "name": "Lights",
          "source": "traffic-lights-york_traffic",
          "source-layer": "traffic_lighting_york_traffic_table",
          "layout": {
            "visibility": "visible",
            "icon-allow-overlap": false,
            "icon-ignore-placement": true,
            "icon-image": "traffic_light",
            "icon-size": [
              "interpolate",
              [
                "linear"
              ],
              [
                "zoom"
              ],
              5,
              0.0000015,
              12,
              0.01,
              16,
              0.025
            ]
          }
        }
      ]
    },
    {
      "name": "England Highway",
      "stack": "https://localhost:3838",
      "expanded": false,
      "sources": [
        {
          "id": "highway",
          "type": "vector",
          "tiles": [
            "http://localhost:3838/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&layers=twa:england_highway_table&bbox={bbox-epsg-3857}&width=256&height=256&srs=EPSG:3857&format=application/vnd.mapbox-vector-tile"
          ]
        }
      ],
      "layers": [
        {
          "id": "highway",
          "type": "line",
          "name": "Highway",
          "source": "highway",
          "source-layer": "england_highway_table",
          "paint": {
            "line-color": "#9E151A",
            "line-width": 1
          }
        }
      ]
    }
  ]
}
